import{j as e}from"./jsx-runtime-CBjAUaf4.js";import{A as H,I as T,B as y}from"./api-input-B7xzUR3Y.js";import{r as o}from"./index-CoAThXCU.js";import"./jsx-runtime-B2VJbz7C.js";function v(){const[C,w]=o.useState(""),[m,b]=o.useState("M1P3C2"),[l,p]=o.useState(!1),[h,x]=o.useState(null),[d,D]=o.useState([]),[P,u]=o.useState(!1),S=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(d,null,2)),u(!0),setTimeout(()=>u(!1),2e3)}catch(s){console.error("Failed to copy:",s)}},g=s=>s.listings?s.listings.map(t=>({address:{area:t.address.area,city:t.address.city,country:t.address.country,streetName:t.address.streetName,streetNumber:t.address.streetNumber,streetSuffix:t.address.streetSuffix,zip:t.address.zip,state:t.address.state},priceHistory:{listPrice:t.listPrice,listDate:t.listDate,originalPrice:t.originalPrice,soldPrice:t.soldPrice,soldDate:t.soldDate},estimate:t.estimate?{high:t.estimate.high,low:t.estimate.low,value:t.estimate.value,date:t.estimate.date,confidence:t.estimate.confidence,history:t.estimate.history}:void 0})):[],A=async s=>{s.preventDefault(),p(!0),x(null);try{const r=await fetch("https://dev.repliers.io/listings",{method:"POST",headers:{"REPLIERS-API-KEY":C,"Content-Type":"application/json",Accept:"application/json","User-Agent":"PostmanRuntime/7.43.4","Cache-Control":"no-cache",Connection:"keep-alive"},body:JSON.stringify({zipCode:m})});if(!r.ok){const L=await r.text();throw new Error(`HTTP error! status: ${r.status}, message: ${L}`)}const c=await r.json(),E=g(c);D(E)}catch(t){x(t instanceof Error?t.message:"An error occurred"),console.error("Error:",t)}finally{p(!1)}},a=s=>new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD",maximumFractionDigits:0}).format(s),n=s=>new Date(s).toLocaleDateString("en-CA",{year:"numeric",month:"long",day:"numeric"});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("form",{onSubmit:A,className:"flex flex-col gap-4",children:[e.jsx(H,{onApiKeyChange:w}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{type:"text",placeholder:"M1P3C2",className:"max-w-[200px]",value:m,onChange:s=>b(s.target.value),required:!0}),e.jsx(y,{type:"submit",disabled:l,children:l?"Searching...":"Search"})]}),h&&e.jsx("div",{className:"text-red-500 text-sm",children:h})]}),d.length>0&&e.jsxs("div",{className:"border rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Property Listings"}),e.jsxs(y,{variant:"outline",size:"sm",onClick:S,className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:[e.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),e.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]}),P?"Copied!":"Copy Response"]})]}),e.jsx("div",{className:"space-y-6",children:d.map((s,t)=>e.jsxs("div",{className:"border-b pb-4 last:border-b-0",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Address"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.address.streetNumber," ",s.address.streetName," ",s.address.streetSuffix,e.jsx("br",{}),s.address.city,", ",s.address.state," ",s.address.zip,e.jsx("br",{}),s.address.country]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Price History"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["List Price:"," ",a(s.priceHistory.listPrice)]}),e.jsxs("p",{children:["Original Price:"," ",a(s.priceHistory.originalPrice)]}),e.jsxs("p",{children:["List Date: ",n(s.priceHistory.listDate)]}),s.priceHistory.soldPrice&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Sold Price:"," ",a(s.priceHistory.soldPrice)]}),e.jsxs("p",{children:["Sold Date:"," ",n(s.priceHistory.soldDate)]})]})]})]}),s.estimate&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Property Estimate"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Current Estimate:"," ",a(s.estimate.value)]}),e.jsxs("p",{children:["Estimate Range: ",a(s.estimate.low)," -"," ",a(s.estimate.high)]}),e.jsxs("p",{children:["Confidence:"," ",(s.estimate.confidence*100).toFixed(1),"%"]}),e.jsxs("p",{children:["Last Updated: ",n(s.estimate.date)]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h4",{className:"font-medium text-gray-600",children:"Complete Price History"}),e.jsx("div",{className:"space-y-1",children:Object.entries(s.estimate.history.mth).sort(([r],[c])=>new Date(c).getTime()-new Date(r).getTime()).map(([r,c])=>e.jsxs("p",{className:"text-sm",children:[new Date(r).toLocaleDateString("en-CA",{year:"numeric",month:"short"}),": ",a(c.value)]},r))})]})]})]})]},t))})]})]})}v.__docgenInfo={description:"",methods:[],displayName:"ZipCodeData"};const z={title:"Components/ZipCodeData",component:v,parameters:{layout:"centered"},tags:["autodocs"]},i={args:{}};var j,f,N;i.parameters={...i.parameters,docs:{...(j=i.parameters)==null?void 0:j.docs,source:{originalSource:`{
  args: {}
}`,...(N=(f=i.parameters)==null?void 0:f.docs)==null?void 0:N.source}}};const F=["Default"];export{i as Default,F as __namedExportsOrder,z as default};
