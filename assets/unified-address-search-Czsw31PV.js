import{j as e}from"./jsx-runtime-CBjAUaf4.js";import{r as c}from"./index-CoAThXCU.js";const C="AIzaSyBqlRCVfRWu5PagapW3CsV1VVba9fIdknA";function G({onPlaceSelect:v,placeholder:A="Enter an address...",className:b,disabled:w=!1,displayAddressComponents:E=!1}){const i=c.useRef(null),m=c.useRef(null),[x,h]=c.useState(!1),[y,S]=c.useState(null),[d,_]=c.useState(null);return c.useEffect(()=>{(async()=>{var u,p,r;if((r=(p=(u=window.google)==null?void 0:u.maps)==null?void 0:p.places)!=null&&r.Autocomplete){h(!0);return}try{const s=document.createElement("script");s.src=`https://maps.googleapis.com/maps/api/js?key=${C}&libraries=places&loading=async&v=weekly`,s.async=!0,s.defer=!0;const N=new Promise((o,t)=>{s.onload=()=>{const l=()=>{var f,n,a;(a=(n=(f=window.google)==null?void 0:f.maps)==null?void 0:n.places)!=null&&a.Autocomplete?o():setTimeout(l,100)};l()},s.onerror=l=>{console.error("Script loading failed:",l),t(new Error("Failed to load Google Maps API script"))}});document.head.appendChild(s),await N,h(!0),S(null)}catch(s){console.error("Error loading Google Maps API:",s),h(!1),S(s instanceof Error?s.message:"Failed to load Google Maps API")}})()},[]),c.useEffect(()=>{var j,u,p;if(!(!x||!i.current||m.current)){if(!((p=(u=(j=window.google)==null?void 0:j.maps)==null?void 0:u.places)!=null&&p.Autocomplete)){console.error("Google Maps Autocomplete not available even though isGoogleLoaded is true"),h(!1);return}try{const r=document.createElement("input");r.type="text",r.placeholder=A,r.className="w-full px-3 py-2 border rounded-md",r.disabled=w;const s=new window.google.maps.places.Autocomplete(r,{types:["address"],fields:["address_components","formatted_address","place_id","geometry"]});i.current&&(i.current.innerHTML="",i.current.appendChild(r),m.current=s);const N=()=>{const o=s.getPlace();if(!o.address_components)return;const t={city:"",streetNumber:"",streetName:"",streetSuffix:"",state:"",postalCode:"",country:""};o.address_components.forEach(f=>{const n=f.types,a=f.long_name;if(n.includes("street_number"))t.streetNumber=a;else if(n.includes("route")){const g=a.split(" ");if(g.length>1){const P=g[g.length-1].toLowerCase();["street","st","avenue","ave","road","rd","boulevard","blvd","lane","ln","drive","dr","court","ct","circle","cir","way","place","pl","terrace","ter","trail","trl","parkway","pkwy","square","sq","highway","hwy"].includes(P)?(t.streetSuffix=g.pop()||"",t.streetName=g.join(" ")):t.streetName=a}else t.streetName=a}else n.includes("locality")?t.city=a:n.includes("administrative_area_level_1")?t.state=a:n.includes("postal_code")?t.postalCode=a:n.includes("country")&&(t.country=a)});const l={address:t,formattedAddress:o.formatted_address||"",placeId:o.place_id||"",geometry:o.geometry?{lat:o.geometry.location.lat(),lng:o.geometry.location.lng()}:void 0};_(l),v(l)};return s.addListener("place_changed",N),()=>{m.current&&(window.google.maps.event.clearInstanceListeners(m.current),m.current=null)}}catch(r){console.error("Error initializing autocomplete:",r)}}},[x,v,A,w]),e.jsx("div",{className:b,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"address-search",className:"text-sm font-medium",children:"Search Address"}),e.jsx("div",{className:"min-w-[400px] w-auto",children:e.jsxs("div",{ref:i,children:[!x&&!y&&e.jsx("div",{className:"text-muted-foreground",children:"Loading Google Maps..."}),y&&e.jsxs("div",{className:"text-red-500 text-sm p-2 border border-red-300 rounded",children:["Error: ",y]})]})})]}),E&&d&&e.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Address Components"}),e.jsxs("dl",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Number:"}),e.jsx("dd",{children:d.address.streetNumber}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Name:"}),e.jsx("dd",{children:d.address.streetName}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Suffix:"}),e.jsx("dd",{children:d.address.streetSuffix}),e.jsx("dt",{className:"font-medium text-gray-600",children:"City:"}),e.jsx("dd",{children:d.address.city}),e.jsx("dt",{className:"font-medium text-gray-600",children:"State:"}),e.jsx("dd",{children:d.address.state}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Postal Code:"}),e.jsx("dd",{children:d.address.postalCode}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Country:"}),e.jsx("dd",{children:d.address.country}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Formatted Address:"}),e.jsx("dd",{className:"col-span-2",children:d.formattedAddress})]})]})]})})}G.__docgenInfo={description:`UnifiedAddressSearch Component

@description Address autocomplete component using Google Places API
@param props - The component props
@returns JSX.Element`,methods:[],displayName:"UnifiedAddressSearch",props:{onPlaceSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(place: PlaceDetails) => void",signature:{arguments:[{type:{name:"PlaceDetails"},name:"place"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Enter an address..."',computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},displayAddressComponents:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};export{G as U};
