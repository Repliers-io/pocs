import{j as e}from"./jsx-runtime-CBjAUaf4.js";import{R as l}from"./index-CoAThXCU.js";import{u as X,F as ee,a as j,b as p,c as u,d as g,e as N,s as se,o as K,f as b}from"./form-BvPo6i_y.js";import{B as n,A as te,I as f}from"./api-input-DWfJo0Ca.js";import"./jsx-runtime-B2VJbz7C.js";import"./index-CfR0xb4d.js";import"./index-fny-Lthe.js";function q({listingData:s}){var m,x;return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"MLS Report"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(s,null,2))},children:"Copy Formatted"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(s))},children:"Copy Raw JSON"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Property Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"MLS Number"}),e.jsx("p",{className:"font-medium",children:s.mlsNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"List Price"}),e.jsxs("p",{className:"font-medium",children:["$",s.listPrice.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Property Type"}),e.jsx("p",{className:"font-medium",children:s.details.propertyType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Style"}),e.jsx("p",{className:"font-medium",children:s.details.style})]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Location Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsxs("p",{className:"font-medium",children:[s.address.streetNumber," ",s.address.streetName," ",s.address.streetSuffix]}),e.jsxs("p",{className:"font-medium",children:[s.address.city,", ",s.address.state," ",s.address.zip]}),((m=s.map)==null?void 0:m.latitude)&&((x=s.map)==null?void 0:x.longitude)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Coordinates"}),e.jsxs("p",{className:"font-medium",children:[s.map.latitude.toFixed(6),","," ",s.map.longitude.toFixed(6)]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Neighborhood"}),e.jsx("p",{className:"font-medium",children:s.address.neighborhood}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Major Intersection"}),e.jsx("p",{className:"font-medium",children:s.address.majorIntersection})]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Property Specifications"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Bedrooms"}),e.jsxs("p",{className:"font-medium",children:[s.details.numBedrooms," +"," ",s.details.numBedroomsPlus]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Bathrooms"}),e.jsx("p",{className:"font-medium",children:s.details.numBathrooms})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Square Footage"}),e.jsx("p",{className:"font-medium",children:s.details.sqft})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Garage Spaces"}),e.jsx("p",{className:"font-medium",children:s.details.numGarageSpaces})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Year Built"}),e.jsx("p",{className:"font-medium",children:s.details.yearBuilt})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Lot Size"}),e.jsxs("p",{className:"font-medium",children:[s.lot.width,"' x ",s.lot.depth,"'"]})]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Key Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["Air Conditioning: ",s.details.airConditioning]}),e.jsxs("li",{children:["Heating: ",s.details.heating]}),e.jsxs("li",{children:["Basement: ",s.details.basement1]}),e.jsxs("li",{children:["Central Vacuum: ",s.details.centralVac]}),e.jsxs("li",{children:["Fireplaces: ",s.details.numFireplaces]})]})}),e.jsx("div",{children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["Garage Type: ",s.details.garage]}),e.jsxs("li",{children:["Exterior: ",s.details.exteriorConstruction1]}),e.jsxs("li",{children:["Foundation: ",s.details.foundationType]}),e.jsxs("li",{children:["Roof: ",s.details.roofMaterial]}),e.jsxs("li",{children:["Water Source: ",s.details.waterSource]})]})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Market History"}),e.jsx("div",{className:"space-y-6",children:s.history.map((r,h)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-lg",children:[r.lastStatus==="Sold"?"Sold":"Listed"," on"," ",new Date(r.listDate).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["MLS #",r.mlsNumber]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",r.listPrice.toLocaleString()]}),r.lastStatus==="Sold"&&r.soldPrice&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Sold for $",r.soldPrice.toLocaleString()]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("p",{className:"font-medium",children:r.lastStatus})]}),r.dom&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Days on Market"}),e.jsx("p",{className:"font-medium",children:r.dom})]}),r.soldDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sold Date"}),e.jsx("p",{className:"font-medium",children:new Date(r.soldDate).toLocaleDateString()})]}),r.originalPrice&&r.originalPrice!==r.listPrice&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Original Price"}),e.jsxs("p",{className:"font-medium",children:["$",r.originalPrice.toLocaleString()]})]})]}),r.description&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("p",{className:"text-sm mt-1",children:r.description})]}),r.latitude&&r.longitude&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Latitude"}),e.jsx("p",{className:"font-medium",children:r.latitude})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Longitude"}),e.jsx("p",{className:"font-medium",children:r.longitude})]})]})]},h))})]})]})]})}q.__docgenInfo={description:"",methods:[],displayName:"MLSReport",props:{listingData:{required:!0,tsType:{name:"any"},description:""}}};const re=K({mlsNumber:b().optional(),address:K({city:b(),streetName:b(),streetNumber:b(),zip:b()})}),ie={mlsNumber:"",address:{city:"King City",streetName:"Clearview Heights",streetNumber:"106",zip:"L7B 1H6"}};function D(){const[s,m]=l.useState(!1),[x,r]=l.useState(null),[h,_]=l.useState(""),[I,V]=l.useState(null),[L,E]=l.useState([]),[A,P]=l.useState(!1),[Y,F]=l.useState(0),[y,M]=l.useState([]),[T,k]=l.useState(!1),[v,$]=l.useState([]),[B,C]=l.useState(!1),o=X({resolver:se(re),defaultValues:ie}),z=t=>{const i=new Date(t),a=new Date;return a.setDate(a.getDate()-7),i>=a},G=(t,i)=>{const a=new Date(t),d=new Date(i),c=Math.abs(d.getTime()-a.getTime());return Math.ceil(c/(1e3*60*60*24))},J=async(t,i)=>{try{const a=await fetch(`https://api.repliers.io/listings?lat=${t}&long=${i}&radius=1&status=A`,{headers:{"REPLIERS-API-KEY":h,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`API request failed with status ${a.status}`);const d=await a.json(),c=d.listings||[];E(c),F(d.count||0);const Z=c.filter(S=>z(S.listDate));M(Z);const R=await fetch(`https://api.repliers.io/listings?lat=${t}&long=${i}&radius=1&status=U`,{headers:{"REPLIERS-API-KEY":h,"Content-Type":"application/json"}});if(!R.ok)throw new Error(`API request failed with status ${R.status}`);const Q=((await R.json()).listings||[]).filter(S=>S.soldDate&&z(S.soldDate));$(Q)}catch(a){console.error("Error fetching nearby listings:",a)}},U=async t=>{var i,a;try{if(m(!0),r(null),E([]),P(!1),F(0),M([]),k(!1),$([]),C(!1),t.mlsNumber){const d=await fetch(`https://api.repliers.io/listings/${t.mlsNumber}`,{headers:{"REPLIERS-API-KEY":h,"Content-Type":"application/json"}});if(!d.ok)throw new Error(`API request failed with status ${d.status}`);const c=await d.json();V(c),(i=c.map)!=null&&i.latitude&&((a=c.map)!=null&&a.longitude)&&await J(c.map.latitude,c.map.longitude)}console.log("Form submitted:",t)}catch(d){r(d instanceof Error?d.message:"An error occurred"),console.error("Error:",d)}finally{m(!1)}};return e.jsx(ee,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(U),className:"space-y-8",children:[e.jsx(te,{onApiKeyChange:_,isEstimates:!1}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Property Information"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx(j,{control:o.control,name:"mlsNumber",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"MLS Number"}),e.jsx(g,{children:e.jsx(f,{...t,placeholder:"Enter MLS number"})}),e.jsx(N,{})]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(j,{control:o.control,name:"address.streetNumber",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"Street Number"}),e.jsx(g,{children:e.jsx(f,{...t})}),e.jsx(N,{})]})}),e.jsx(j,{control:o.control,name:"address.streetName",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"Street Name"}),e.jsx(g,{children:e.jsx(f,{...t})}),e.jsx(N,{})]})}),e.jsx(j,{control:o.control,name:"address.city",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"City"}),e.jsx(g,{children:e.jsx(f,{...t})}),e.jsx(N,{})]})}),e.jsx(j,{control:o.control,name:"address.zip",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"ZIP Code"}),e.jsx(g,{children:e.jsx(f,{...t})}),e.jsx(N,{})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{type:"submit",disabled:s,className:"w-full",children:s?"Loading...":"Search"}),x&&e.jsxs("div",{className:"p-4 text-sm text-red-500 bg-red-50 rounded-md border border-red-200",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Error"}),x]}),I&&e.jsx(q,{listingData:I}),v.length>0&&!B&&e.jsxs("div",{className:"p-4 bg-purple-50 rounded-md border border-purple-200",children:[e.jsxs("p",{className:"text-sm text-purple-700 mb-2",children:["Found ",v.length," properties sold in the last 7 days within 1km radius"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>C(!0),className:"text-purple-700 hover:text-purple-800",children:"Show Recent Sales"})]}),B&&v.length>0&&e.jsxs("div",{className:"p-4 bg-white rounded-md border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Recent Sales (Last 7 Days)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Within 1km radius of the property"})]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>C(!1),children:"Hide"})]}),e.jsx("div",{className:"space-y-2",children:v.map((t,i)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md hover:bg-gray-100",children:[e.jsxs("p",{className:"font-medium",children:[t.address.streetNumber," ",t.address.streetName," ",t.address.streetSuffix]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"List Price"}),e.jsxs("p",{className:"font-medium text-gray-700",children:["$",t.listPrice.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sold Price"}),e.jsxs("p",{className:"font-medium text-green-600",children:["$",t.soldPrice.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Days on Market"}),e.jsxs("p",{className:"font-medium text-gray-700",children:[G(t.listDate,t.soldDate)," ","days"]})]})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Sold: ",new Date(t.soldDate).toLocaleDateString()]})]},i))})]}),y.length>0&&!T&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-md border border-green-200",children:[e.jsxs("p",{className:"text-sm text-green-700 mb-2",children:["Found ",y.length," new listings in the last 7 days within 1km radius"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>k(!0),className:"text-green-700 hover:text-green-800",children:"Show Recent Listings"})]}),T&&y.length>0&&e.jsxs("div",{className:"p-4 bg-white rounded-md border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Recent Listings (Last 7 Days)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Within 1km radius of the property"})]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>k(!1),children:"Hide"})]}),e.jsx("div",{className:"space-y-2",children:y.map((t,i)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md hover:bg-gray-100",children:[e.jsxs("p",{className:"font-medium",children:[t.address.streetNumber," ",t.address.streetName," ",t.address.streetSuffix]}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["$",t.listPrice.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Listed:"," ",new Date(t.listDate).toLocaleDateString()]})]})]},i))})]}),L.length>0&&!A&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-md border border-blue-200",children:[e.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["Found ",Y," active listings within 1km radius"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>P(!0),className:"text-blue-700 hover:text-blue-800",children:"Show Nearby Listings"})]}),A&&L.length>0&&e.jsxs("div",{className:"p-4 bg-white rounded-md border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Nearby Active Listings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"All active listings within 1km radius"})]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>P(!1),children:"Hide"})]}),e.jsx("div",{className:"space-y-2",children:L.map((t,i)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md hover:bg-gray-100",children:[e.jsxs("p",{className:"font-medium",children:[t.address.streetNumber," ",t.address.streetName," ",t.address.streetSuffix]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["$",t.listPrice.toLocaleString()]})]},i))})]})]})]})})}D.__docgenInfo={description:"",methods:[],displayName:"MarketInsightsByAddress"};const je={title:"POCS/Statistics/Market Insights By Address",component:D,parameters:{layout:"centered"},tags:["autodocs"]},w={args:{}};var O,W,H;w.parameters={...w.parameters,docs:{...(O=w.parameters)==null?void 0:O.docs,source:{originalSource:`{
  args: {}
}`,...(H=(W=w.parameters)==null?void 0:W.docs)==null?void 0:H.source}}};const pe=["WorkingDemo"];export{w as WorkingDemo,pe as __namedExportsOrder,je as default};
