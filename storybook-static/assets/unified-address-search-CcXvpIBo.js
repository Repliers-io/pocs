import{j as e}from"./jsx-runtime-CBjAUaf4.js";import{r as i}from"./index-CoAThXCU.js";const P="AIzaSyBqlRCVfRWu5PagapW3CsV1VVba9fIdknA";function C({onPlaceSelect:j,placeholder:v="Enter an address...",className:A,disabled:w=!1,displayAddressComponents:S=!1}){const y=i.useRef(null),m=i.useRef(null),[x,f]=i.useState(!1),[N,b]=i.useState(null),[a,E]=i.useState(null);return i.useEffect(()=>{(async()=>{var u,p,l;if((l=(p=(u=window.google)==null?void 0:u.maps)==null?void 0:p.places)!=null&&l.Autocomplete){f(!0);return}try{const s=document.createElement("script");s.src=`https://maps.googleapis.com/maps/api/js?key=${P}&libraries=places&loading=async&v=weekly`,s.async=!0,s.defer=!0;const o=new Promise((t,g)=>{s.onload=()=>{const c=()=>{var d,r,n;(n=(r=(d=window.google)==null?void 0:d.maps)==null?void 0:r.places)!=null&&n.Autocomplete?t():setTimeout(c,100)};c()},s.onerror=c=>{console.error("Script loading failed:",c),g(new Error("Failed to load Google Maps API script"))}});document.head.appendChild(s),await o,f(!0),b(null)}catch(s){console.error("Error loading Google Maps API:",s),f(!1),b(s instanceof Error?s.message:"Failed to load Google Maps API")}})()},[]),i.useEffect(()=>{var h,u,p;if(!(!x||!y.current||m.current)){if(!((p=(u=(h=window.google)==null?void 0:h.maps)==null?void 0:u.places)!=null&&p.Autocomplete)){console.error("Google Maps Autocomplete not available even though isGoogleLoaded is true"),f(!1);return}try{const l=new window.google.maps.places.Autocomplete(y.current,{types:["address"],fields:["address_components","formatted_address","place_id","geometry"]});m.current=l;const s=()=>{const o=l.getPlace();if(!o.address_components)return;const t={city:"",streetNumber:"",streetName:"",streetSuffix:"",state:"",postalCode:"",country:""};o.address_components.forEach(c=>{const d=c.types,r=c.long_name;if(d.includes("street_number"))t.streetNumber=r;else if(d.includes("route")){const n=r.split(" ");if(n.length>1){const _=n[n.length-1].toLowerCase();["street","st","avenue","ave","road","rd","boulevard","blvd","lane","ln","drive","dr","court","ct","circle","cir","way","place","pl","terrace","ter","trail","trl","parkway","pkwy","square","sq","highway","hwy"].includes(_)?(t.streetSuffix=n.pop()||"",t.streetName=n.join(" ")):t.streetName=r}else t.streetName=r}else d.includes("locality")?t.city=r:d.includes("administrative_area_level_1")?t.state=r:d.includes("postal_code")?t.postalCode=r:d.includes("country")&&(t.country=r)});const g={address:t,formattedAddress:o.formatted_address||"",placeId:o.place_id||"",geometry:o.geometry?{lat:o.geometry.location.lat(),lng:o.geometry.location.lng()}:void 0};E(g),j(g)};return l.addListener("place_changed",s),()=>{m.current&&(window.google.maps.event.clearInstanceListeners(m.current),m.current=null)}}catch(l){console.error("Error initializing autocomplete:",l)}}},[x,j]),e.jsx("div",{className:A,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"address-search",className:"text-sm font-medium",children:"Search Address"}),e.jsx("div",{className:"min-w-[400px] w-auto",children:x?e.jsx("input",{ref:y,id:"address-search",type:"text",placeholder:v,disabled:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-4 00 focus:border-blue-500"}):N?e.jsxs("div",{className:"text-red-500 text-sm p-2 border border-red-300 rounded",children:["Error: ",N]}):e.jsx("div",{className:"text-muted-foreground px-3 py-2 border border-gray-300 rounded-md bg-gray-50",children:"Loading Google Maps..."})})]}),S&&a&&e.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Address Components"}),e.jsxs("dl",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Number:"}),e.jsx("dd",{children:a.address.streetNumber}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Name:"}),e.jsx("dd",{children:a.address.streetName}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Street Suffix:"}),e.jsx("dd",{children:a.address.streetSuffix}),e.jsx("dt",{className:"font-medium text-gray-600",children:"City:"}),e.jsx("dd",{children:a.address.city}),e.jsx("dt",{className:"font-medium text-gray-600",children:"State:"}),e.jsx("dd",{children:a.address.state}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Postal Code:"}),e.jsx("dd",{children:a.address.postalCode}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Country:"}),e.jsx("dd",{children:a.address.country}),e.jsx("dt",{className:"font-medium text-gray-600",children:"Formatted Address:"}),e.jsx("dd",{className:"col-span-2",children:a.formattedAddress})]})]})]})})}C.__docgenInfo={description:`UnifiedAddressSearch Component

@description Address autocomplete component using Google Places API
@param props - The component props
@returns JSX.Element`,methods:[],displayName:"UnifiedAddressSearch",props:{onPlaceSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(place: PlaceDetails) => void",signature:{arguments:[{type:{name:"PlaceDetails"},name:"place"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Enter an address..."',computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},displayAddressComponents:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};export{C as U};
