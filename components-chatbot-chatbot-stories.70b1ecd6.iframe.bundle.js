"use strict";(self.webpackChunkpocs=self.webpackChunkpocs||[]).push([[978],{"./src/components/chatbot/chatbot.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CustomBranding:()=>CustomBranding,WorkingDemo:()=>WorkingDemo,__namedExportsOrder:()=>__namedExportsOrder,default:()=>chatbot_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),x=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/x.js"),message_circle=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/message-circle.js"),proxy=__webpack_require__("./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs"),AnimatePresence=__webpack_require__("./node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs");function FloatingChatButton({isOpen,onClick,position="bottom-right"}){const positionClasses="bottom-right"===position?"right-6 bottom-6":"left-6 bottom-6";return(0,jsx_runtime.jsx)(proxy.E.button,{onClick,className:`\n        fixed ${positionClasses} z-50\n        w-16 h-16\n        bg-gradient-to-r from-blue-600 to-blue-700\n        text-white\n        rounded-full\n        shadow-2xl\n        hover:shadow-3xl\n        flex items-center justify-center\n        transition-shadow duration-300\n        focus:outline-none focus:ring-4 focus:ring-blue-300\n      `,whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":isOpen?"Close chat":"Open chat","aria-expanded":isOpen,children:(0,jsx_runtime.jsx)(AnimatePresence.M,{mode:"wait",children:isOpen?(0,jsx_runtime.jsx)(proxy.E.div,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.2},children:(0,jsx_runtime.jsx)(x.Z,{className:"w-7 h-7"})},"close"):(0,jsx_runtime.jsx)(proxy.E.div,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.2},children:(0,jsx_runtime.jsx)(message_circle.Z,{className:"w-7 h-7"})},"message")})})}FloatingChatButton.__docgenInfo={description:"FloatingChatButton Component\n\nA circular floating action button for opening/closing the chat.\nDisplays a message icon when closed, X icon when open.\n\nFeatures:\n- Smooth scale animations on hover\n- Icon transition between MessageCircle and X\n- Positioned at bottom right/left\n- Gradient background\n- Accessibility labels",methods:[],displayName:"FloatingChatButton",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},position:{required:!1,tsType:{name:"union",raw:'"bottom-right" | "bottom-left"',elements:[{name:"literal",value:'"bottom-right"'},{name:"literal",value:'"bottom-left"'}]},description:"",defaultValue:{value:'"bottom-right"',computed:!1}}}};var user=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/user.js"),bot=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/bot.js"),loader_circle=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/loader-circle.js"),mic=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/mic.js"),arrow_up=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/arrow-up.js"),house=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/house.js"),chevron_up=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-up.js"),chevron_down=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-down.js"),bed=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/bed.js"),bath=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/bath.js"),maximize_2=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/maximize-2.js");function getErrorMessage(error){if(error instanceof Error){if("IRRELEVANT_QUERY"===error.message)return"I can help you find properties! Try asking about homes, condos, or apartments for sale. For example: '3 bedroom condo in Toronto' or 'house under $800k'.";if(error.message.includes("API error"))return"Sorry, I'm having trouble connecting to the property search service. Please try again in a moment.";if(error.message.includes("401")||error.message.includes("403"))return"There's an issue with the API configuration. Please contact support.";if(error.message.includes("timeout"))return"The search is taking longer than expected. Please try again."}return"Sorry, something went wrong. Please try again or rephrase your search."}function formatAddress(address){return`${[address.streetNumber,address.streetName,address.streetSuffix].filter(Boolean).join(" ")}, ${[address.city,address.province].filter(Boolean).join(", ")}`}function PropertyCard({listing,onViewDetails}){var _listing_images;const[imageLoaded,setImageLoaded]=(0,react.useState)(!1),[imageError,setImageError]=(0,react.useState)(!1),imageUrl=function getImageUrl(imageUrl){if(!imageUrl)return;let fullUrl=imageUrl;imageUrl.startsWith("http://")||imageUrl.startsWith("https://")||(fullUrl=`https://cdn.repliers.io/${imageUrl.startsWith("/")?imageUrl.slice(1):imageUrl}`);if(fullUrl.includes("class="))return fullUrl;const separator=fullUrl.includes("?")?"&":"?";return`${fullUrl}${separator}class=small`}(null===(_listing_images=listing.images)||void 0===_listing_images?void 0:_listing_images[0]),showImage=imageUrl&&!imageError,propertySummary=function getPropertySummary(listing){const type=listing.propertyType||"property",address=formatAddress(listing.address);return`${listing.bedrooms} bedroom, ${listing.bathrooms} bathroom ${type} at ${address}`}(listing),handleClick=()=>{onViewDetails?onViewDetails(listing):alert(`Property details:\nMLS #${listing.mlsNumber}\n\nFull details view coming soon!`)};return(0,jsx_runtime.jsxs)("div",{className:" bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300 ease-out cursor-pointer focus-within:ring-2 focus-within:ring-blue-500 ",onClick:handleClick,onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),handleClick())},tabIndex:0,role:"button","aria-label":`View details for ${propertySummary}`,children:[(0,jsx_runtime.jsxs)("div",{className:"relative h-40 bg-gray-200 overflow-hidden",children:[showImage?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!imageLoaded&&(0,jsx_runtime.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,jsx_runtime.jsx)("div",{className:"w-10 h-10 border-3 border-gray-300 border-t-blue-600 rounded-full animate-spin"})}),(0,jsx_runtime.jsx)("img",{src:imageUrl,alt:`Property at ${formatAddress(listing.address)}`,className:`\n                w-full h-full object-cover\n                transition-opacity duration-300\n                ${imageLoaded?"opacity-100":"opacity-0"}\n              `,onLoad:()=>setImageLoaded(!0),onError:()=>setImageError(!0),loading:"lazy"})]}):(0,jsx_runtime.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:(0,jsx_runtime.jsx)(house.Z,{className:"w-12 h-12 text-gray-400"})}),listing.propertyType&&(0,jsx_runtime.jsx)("div",{className:"absolute top-2 left-2 bg-white/90 backdrop-blur-sm px-2 py-0.5 rounded-full text-[10px] font-semibold text-gray-700 shadow-md",children:listing.propertyType}),listing.status&&(0,jsx_runtime.jsx)("div",{className:"absolute top-2 right-2 bg-blue-600 text-white px-2 py-0.5 rounded-full text-[10px] font-semibold shadow-md",children:listing.status})]}),(0,jsx_runtime.jsxs)("div",{className:"p-3 space-y-2",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-0.5",children:[(0,jsx_runtime.jsx)("div",{className:"text-xl font-bold text-gray-900",children:(price=listing.listPrice,new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(price))}),(0,jsx_runtime.jsxs)("div",{className:"text-[10px] text-gray-500",children:["MLS #",listing.mlsNumber]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Bedrooms",children:[(0,jsx_runtime.jsx)(bed.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.bedrooms})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Bathrooms",children:[(0,jsx_runtime.jsx)(bath.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.bathrooms})]}),listing.sqft&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Square footage",children:[(0,jsx_runtime.jsx)(maximize_2.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.sqft.toLocaleString()})]})]}),(0,jsx_runtime.jsx)("div",{className:"text-xs text-gray-700 pt-1 border-t border-gray-100",children:formatAddress(listing.address)}),(0,jsx_runtime.jsxs)("button",{className:" w-full mt-1.5 py-1.5 px-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white text-xs font-semibold rounded-lg hover:from-blue-700 hover:to-blue-800 active:scale-95 transition-all duration-200 flex items-center justify-center gap-1.5 ",onClick:e=>{e.stopPropagation(),handleClick()},"aria-label":`View full details for ${propertySummary}`,children:["View Details",(0,jsx_runtime.jsx)("span",{"aria-hidden":"true",children:"→"})]})]})]});var price}function PropertyResults({listings,onViewDetails}){const[showAll,setShowAll]=(0,react.useState)(!1);if(!listings||0===listings.length)return(0,jsx_runtime.jsxs)("div",{className:"mt-4 p-6 bg-gray-50 rounded-xl border border-gray-200 text-center space-y-3",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-center",children:(0,jsx_runtime.jsx)("div",{className:"p-3 bg-white rounded-full shadow-sm",children:(0,jsx_runtime.jsx)(house.Z,{className:"w-8 h-8 text-gray-400"})})}),(0,jsx_runtime.jsxs)("div",{className:"space-y-1",children:[(0,jsx_runtime.jsx)("p",{className:"text-gray-700 font-medium",children:"No properties found"}),(0,jsx_runtime.jsx)("p",{className:"text-sm text-gray-500",children:"Try adjusting your search criteria or exploring different neighborhoods."})]})]});const displayedListings=showAll?listings:listings.slice(0,5),hasMore=listings.length>5;return(0,jsx_runtime.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-between px-1",children:(0,jsx_runtime.jsxs)("p",{className:"text-sm font-semibold text-gray-700",children:["Found ",listings.length," ",1===listings.length?"property":"properties"]})}),(0,jsx_runtime.jsx)("div",{className:" grid grid-cols-1 md:grid-cols-2 gap-4 animate-fadeIn ",children:displayedListings.map(((listing,index)=>(0,jsx_runtime.jsx)("div",{className:"animate-slideUp",style:{animationDelay:.1*index+"s"},children:(0,jsx_runtime.jsx)(PropertyCard,{listing,onViewDetails})},listing.mlsNumber)))}),hasMore&&(0,jsx_runtime.jsx)("div",{className:"flex justify-center pt-2",children:(0,jsx_runtime.jsx)("button",{onClick:()=>setShowAll(!showAll),className:" flex items-center gap-2 px-6 py-2 bg-white border-2 border-gray-300 text-gray-700 font-medium text-sm rounded-lg hover:border-blue-500 hover:text-blue-600 active:scale-95 transition-all duration-200 ","aria-label":showAll?"Show fewer properties":"Show all properties",children:showAll?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Show Less",(0,jsx_runtime.jsx)(chevron_up.Z,{className:"w-4 h-4"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Show ",listings.length-5," More",(0,jsx_runtime.jsx)(chevron_down.Z,{className:"w-4 h-4"})]})})})]})}if(PropertyCard.__docgenInfo={description:"PropertyCard Component\n\nDisplays a single property listing in a beautiful, responsive card format.\nIncludes image, price, specs (bed/bath/sqft), and address.\n\nFeatures:\n- Lazy-loaded images with placeholder\n- Responsive design (full width mobile, fixed width desktop)\n- Hover effects\n- Accessible with ARIA labels",methods:[],displayName:"PropertyCard",props:{listing:{required:!0,tsType:{name:"PropertyListing"},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(listing: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"listing"}],return:{name:"void"}}},description:""}}},"undefined"!=typeof document){const style=document.createElement("style");style.textContent="\n    @keyframes fadeIn {\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    }\n\n    @keyframes slideUp {\n      from {\n        opacity: 0;\n        transform: translateY(10px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n\n    .animate-fadeIn {\n      animation: fadeIn 0.5s ease-out;\n    }\n\n    .animate-slideUp {\n      opacity: 0;\n      animation: slideUp 0.4s ease-out forwards;\n    }\n  ",document.head.querySelector("style[data-property-animations]")||(style.setAttribute("data-property-animations","true"),document.head.appendChild(style))}PropertyResults.__docgenInfo={description:'PropertyResults Component\n\nDisplays a grid of property cards with pagination controls.\n\nFeatures:\n- Responsive grid (1 col mobile, 2 col desktop)\n- Show 5 properties initially, "Show more" for rest\n- Empty state with helpful message\n- Staggered fade-in animations\n- Property count header',methods:[],displayName:"PropertyResults",props:{listings:{required:!0,tsType:{name:"Array",elements:[{name:"PropertyListing"}],raw:"PropertyListing[]"},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(listing: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"listing"}],return:{name:"void"}}},description:""}}};var console=__webpack_require__("./node_modules/console-browserify/index.js");function ChatPanel({isOpen,onClose,messages,isLoading,onSendMessage,placeholder="Ask me anything about properties...",onPropertyClick,onShowAllListings,width="500px",mode="nlp"}){const[inputValue,setInputValue]=(0,react.useState)(""),messagesEndRef=(0,react.useRef)(null),inputRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{var _messagesEndRef_current;isOpen&&(null===(_messagesEndRef_current=messagesEndRef.current)||void 0===_messagesEndRef_current||_messagesEndRef_current.scrollIntoView({behavior:"smooth"}))}),[messages,isOpen]),(0,react.useEffect)((()=>{var _inputRef_current;isOpen&&!isLoading&&(null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.focus())}),[isOpen,isLoading]),(0,react.useEffect)((()=>{inputRef.current&&(inputRef.current.style.height="auto",inputRef.current.style.height=`${inputRef.current.scrollHeight}px`)}),[inputValue]);const handleSend=()=>{inputValue.trim()&&!isLoading&&(onSendMessage(inputValue),setInputValue(""))};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(AnimatePresence.M,{children:isOpen&&(0,jsx_runtime.jsx)(proxy.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/30 z-40 md:hidden",onClick:onClose})}),(0,jsx_runtime.jsx)(AnimatePresence.M,{children:isOpen&&(0,jsx_runtime.jsxs)(proxy.E.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed right-0 top-0 h-full z-50 bg-white shadow-2xl flex flex-col w-full",style:{width:`min(100vw, ${width})`},children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Chat"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-400 font-normal",children:"copilot"===mode?"(Copilot)":"(Repliers NLP)"})]}),(0,jsx_runtime.jsx)("button",{onClick:onClose,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close chat",children:(0,jsx_runtime.jsx)(x.Z,{className:"w-5 h-5 text-gray-600"})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:[messages.map(((message,index)=>(0,jsx_runtime.jsxs)(proxy.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`\n                    flex gap-4 py-6 px-4\n                    ${"user"===message.role?"bg-white flex-row-reverse":"bg-gray-50/50"}\n                    ${0!==index?"border-t border-gray-100":""}\n                  `,children:[(0,jsx_runtime.jsx)("div",{className:"shrink-0",children:"user"===message.role?(0,jsx_runtime.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center",children:(0,jsx_runtime.jsx)(user.Z,{className:"w-5 h-5 text-white"})}):(0,jsx_runtime.jsx)("div",{className:"w-8 h-8 rounded-full bg-emerald-600 flex items-center justify-center",children:(0,jsx_runtime.jsx)(bot.Z,{className:"w-5 h-5 text-white"})})}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 min-w-0 space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"prose prose-sm max-w-none",children:[message.isLoading&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,jsx_runtime.jsx)(loader_circle.Z,{className:"w-4 h-4 animate-spin"}),(0,jsx_runtime.jsx)("span",{className:"text-sm",children:"Thinking..."})]}),!message.isLoading&&(0,jsx_runtime.jsx)("p",{className:`\n                            text-[15px] leading-7 whitespace-pre-wrap\n                            ${message.error?"text-red-700":"text-gray-900"}\n                          `,children:message.content})]}),"assistant"===message.role&&message.propertyResults&&message.propertyResults.length>0&&(0,jsx_runtime.jsxs)("div",{className:"mt-4",children:[(0,jsx_runtime.jsx)(PropertyResults,{listings:message.propertyResults,onViewDetails:onPropertyClick}),message.propertyResults.length>5&&(0,jsx_runtime.jsx)("div",{className:"mt-3",children:(0,jsx_runtime.jsxs)("button",{onClick:()=>null==onShowAllListings?void 0:onShowAllListings(message.propertyResults),className:" w-full px-4 py-2.5 bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 text-gray-700 text-sm font-medium rounded-lg transition-all ",children:["View all ",message.propertyResults.length," listings"]})})]})]})]},message.id))),isLoading&&!messages.some((m=>m.isLoading))&&(0,jsx_runtime.jsxs)("div",{className:"flex gap-4 py-6 px-4 bg-gray-50/50 border-t border-gray-100",children:[(0,jsx_runtime.jsx)("div",{className:"w-8 h-8 rounded-full bg-emerald-600 flex items-center justify-center shrink-0",children:(0,jsx_runtime.jsx)(bot.Z,{className:"w-5 h-5 text-white"})}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,jsx_runtime.jsx)(loader_circle.Z,{className:"w-4 h-4 animate-spin"}),(0,jsx_runtime.jsx)("span",{className:"text-sm",children:"Thinking..."})]})]}),(0,jsx_runtime.jsx)("div",{ref:messagesEndRef})]}),(0,jsx_runtime.jsxs)("div",{className:"p-4 bg-white",children:[(0,jsx_runtime.jsxs)("div",{className:"relative flex items-end bg-gray-100 rounded-3xl px-4 py-3 shadow-sm",children:[(0,jsx_runtime.jsx)("textarea",{ref:inputRef,value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),handleSend())},placeholder,disabled:isLoading,rows:1,className:" flex-1 px-4 py-2 bg-transparent focus:outline-none text-[15px] leading-6 text-gray-900 placeholder:text-gray-500 resize-none max-h-40 ",style:{minHeight:"28px",lineHeight:"1.5"},"aria-label":"Message input"}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1 shrink-0 mb-0.5",children:[!inputValue.trim()&&(0,jsx_runtime.jsx)("button",{className:"p-2 hover:bg-gray-200 rounded-full transition-colors","aria-label":"Voice input",onClick:()=>{const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SpeechRecognition)return void alert("Speech recognition is not supported in your browser. Please try Chrome or Edge.");const recognition=new SpeechRecognition;recognition.lang="en-US",recognition.interimResults=!1,recognition.maxAlternatives=1,recognition.onstart=()=>{console.log("Voice recognition started. Speak now...")},recognition.onresult=event=>{var _inputRef_current;const transcript=event.results[0][0].transcript;setInputValue(transcript),null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.focus()},recognition.onerror=event=>{console.error("Speech recognition error:",event.error),"not-allowed"===event.error&&alert("Microphone access denied. Please allow microphone access.")},recognition.start()},children:(0,jsx_runtime.jsx)(mic.Z,{className:"w-5 h-5 text-gray-600"})}),inputValue.trim()&&(0,jsx_runtime.jsx)("button",{onClick:handleSend,disabled:isLoading,className:" p-2 bg-gray-900 text-white rounded-full hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all flex items-center justify-center ","aria-label":"Send message",children:(0,jsx_runtime.jsx)(arrow_up.Z,{className:"w-5 h-5"})})]})]}),(0,jsx_runtime.jsx)("p",{className:"text-[11px] text-gray-400 mt-2 text-center",children:"Press Enter to send • Shift+Enter for new line"})]})]})})]})}ChatPanel.__docgenInfo={description:"ChatPanel Component - Claude-style Chat UI\n\nA modern, clean chat interface inspired by Claude/ChatGPT.\nSlides in from the right side of the screen.\n\nFeatures:\n- Minimal, clean design\n- Slides in/out with framer-motion\n- Auto-scrolling messages\n- Property results inline with messages\n- Larger, auto-resizing text input\n- Desktop: ~400px width, full height\n- Mobile: Full screen",methods:[],displayName:"ChatPanel",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},messages:{required:!0,tsType:{name:"Array",elements:[{name:"ChatMessage"}],raw:"ChatMessage[]"},description:""},isLoading:{required:!0,tsType:{name:"boolean"},description:""},onSendMessage:{required:!0,tsType:{name:"signature",type:"function",raw:"(message: string) => void",signature:{arguments:[{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Ask me anything about properties..."',computed:!1}},onPropertyClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(property: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"property"}],return:{name:"void"}}},description:""},onShowAllListings:{required:!1,tsType:{name:"signature",type:"function",raw:"(listings: PropertyListing[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"PropertyListing"}],raw:"PropertyListing[]"},name:"listings"}],return:{name:"void"}}},description:""},width:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"500px"',computed:!1}},mode:{required:!1,tsType:{name:"union",raw:"'copilot' | 'nlp'",elements:[{name:"literal",value:"'copilot'"},{name:"literal",value:"'nlp'"}]},description:"",defaultValue:{value:'"nlp"',computed:!1}}}};var chevron_left=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-left.js"),chevron_right=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-right.js");function PropertyDetailsView({listing}){var _listing_details,_listing_details1,_listing_details2,_listing_details3,_listing_details4,_listing_taxes,_listing_condominium_fees,_listing_condominium,_listing_details5,_listing_details6,_listing_details7,_listing_timestamps,_listing_timestamps1,_listing_details8,_listing_details9,_listing_details10,_listing_details11,_listing_details12,_listing_details13,_listing_details14,_listing_details15,_listing_details16,_listing_details17,_listing_details18,_listing_details19,_listing_details20,_listing_details21,_listing_details22,_listing_details23,_listing_lot,_listing_condominium_amenities,_listing_condominium1,_listing_nearby_amenities,_listing_nearby,_listing_condominium_amenities1,_listing_condominium2,_listing_nearby_amenities1,_listing_nearby1,_listing_office,_listing_taxes1,_listing_condominium_fees1,_listing_condominium3,_listing_condominium4,_listing_timestamps2,_listing_timestamps3;const[currentImageIndex,setCurrentImageIndex]=(0,react.useState)(0),formatPrice=price=>`$${price.toLocaleString()}`,getImageUrl=(imagePath,size="medium")=>imagePath.includes("cdn.repliers.io")?imagePath:`https://cdn.repliers.io/${imagePath}?class=${size}`,images=listing.images||[],displayPrice=listing.listPrice||listing.price,displayBeds=(null===(_listing_details=listing.details)||void 0===_listing_details?void 0:_listing_details.numBedrooms)||listing.bedrooms||listing.beds,displayBaths=(null===(_listing_details1=listing.details)||void 0===_listing_details1?void 0:_listing_details1.numBathrooms)||listing.bathrooms||listing.baths,displaySqft=listing.sqft||(null===(_listing_details2=listing.details)||void 0===_listing_details2?void 0:_listing_details2.sqft),displayYearBuilt=(null===(_listing_details3=listing.details)||void 0===_listing_details3?void 0:_listing_details3.yearBuilt)||listing.yearBuilt,daysOnMarket=listing.simpleDaysOnMarket||listing.daysOnMarket,propertyStatus=listing.standardStatus||listing.status,description=(null===(_listing_details4=listing.details)||void 0===_listing_details4?void 0:_listing_details4.description)||listing.description;return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[images.length>0&&(0,jsx_runtime.jsxs)("div",{className:"relative bg-gray-900 flex",style:{height:"400px"},children:[(0,jsx_runtime.jsxs)("div",{className:"flex-1 relative",children:[(0,jsx_runtime.jsx)("img",{src:getImageUrl(images[currentImageIndex],"large"),alt:`Property photo ${currentImageIndex+1}`,className:"w-full h-full object-cover"}),images.length>1&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{onClick:()=>setCurrentImageIndex((prev=>(prev-1+images.length)%images.length)),className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-2 rounded-full shadow-lg transition-all","aria-label":"Previous image",children:(0,jsx_runtime.jsx)(chevron_left.Z,{className:"w-6 h-6 text-gray-800"})}),(0,jsx_runtime.jsx)("button",{onClick:()=>setCurrentImageIndex((prev=>(prev+1)%images.length)),className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-2 rounded-full shadow-lg transition-all","aria-label":"Next image",children:(0,jsx_runtime.jsx)(chevron_right.Z,{className:"w-6 h-6 text-gray-800"})})]}),(0,jsx_runtime.jsxs)("div",{className:"absolute bottom-4 left-4 bg-black/60 text-white px-3 py-1 rounded-full text-sm",children:[currentImageIndex+1," / ",images.length]})]}),(0,jsx_runtime.jsx)("div",{className:"w-32 bg-gray-900 overflow-y-auto",children:images.slice(0,12).map(((imageUrl,index)=>(0,jsx_runtime.jsx)("div",{onClick:()=>setCurrentImageIndex(index),className:`cursor-pointer border-2 ${index===currentImageIndex?"border-blue-500":"border-transparent"} hover:border-blue-300 transition-all`,children:(0,jsx_runtime.jsx)("img",{src:getImageUrl(imageUrl,"small"),alt:`Thumbnail ${index+1}`,className:"w-full aspect-square object-cover"})},index)))})]}),(0,jsx_runtime.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,jsx_runtime.jsxs)("div",{className:"p-6 max-w-4xl",children:[(0,jsx_runtime.jsxs)("div",{className:"mb-8",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,jsx_runtime.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:displayPrice?formatPrice(displayPrice):"Price on request"}),propertyStatus&&(0,jsx_runtime.jsx)("span",{className:"px-3 py-1 text-sm font-medium bg-green-100 text-green-800 rounded-full",children:propertyStatus})]}),(0,jsx_runtime.jsx)("p",{className:"text-xl text-gray-700",children:(address=>{if("string"==typeof address)return address;if(!address||"object"!=typeof address)return"Address not available";const parts=[];address.unitNumber&&parts.push(`#${address.unitNumber}`),address.streetNumber&&parts.push(address.streetNumber),address.streetName&&parts.push(address.streetName),address.streetSuffix&&parts.push(address.streetSuffix);const streetAddress=parts.join(" "),city=address.city||"",province=address.state||address.province||"",zip=address.zip||address.postalCode||"";return`${streetAddress}${city?`, ${city}`:""}${province?`, ${province}`:""}${zip?` ${zip}`:""}`})(listing.address)}),(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[void 0!==displayBeds&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:displayBeds}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Bedrooms"})]}),void 0!==displayBaths&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:displayBaths}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Bathrooms"})]}),displaySqft&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:displaySqft}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Square Feet"})]}),displayYearBuilt&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:displayYearBuilt}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Year Built"})]}),(null===(_listing_taxes=listing.taxes)||void 0===_listing_taxes?void 0:_listing_taxes.annualAmount)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:formatPrice(listing.taxes.annualAmount)}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Annual Tax"})]}),(null===(_listing_condominium=listing.condominium)||void 0===_listing_condominium||null===(_listing_condominium_fees=_listing_condominium.fees)||void 0===_listing_condominium_fees?void 0:_listing_condominium_fees.maintenance)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsxs)("div",{className:"text-gray-900 font-semibold text-xl",children:[formatPrice(listing.condominium.fees.maintenance),"/mo"]}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Condo Fees"})]}),daysOnMarket&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-xl",children:daysOnMarket}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Days on Market"})]})]})]}),description&&(0,jsx_runtime.jsxs)("div",{className:"mb-10",children:[(0,jsx_runtime.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 pb-3 border-b-2 border-gray-200",children:"About This Property"}),(0,jsx_runtime.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:description})]}),(0,jsx_runtime.jsxs)("div",{className:"mb-10",children:[(0,jsx_runtime.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 pb-3 border-b-2 border-gray-200",children:"Property Details"}),(0,jsx_runtime.jsxs)("div",{className:"bg-gray-50 rounded-xl overflow-hidden",children:[(0,jsx_runtime.jsxs)("details",{className:"border-b border-gray-200",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Overview"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsx)("div",{className:"px-7 py-6 bg-white",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[propertyStatus&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:propertyStatus}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Status"})]}),((null===(_listing_details5=listing.details)||void 0===_listing_details5?void 0:_listing_details5.propertyType)||listing.propertyType)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:(null===(_listing_details6=listing.details)||void 0===_listing_details6?void 0:_listing_details6.propertyType)||listing.propertyType}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Property Type"})]}),(null===(_listing_details7=listing.details)||void 0===_listing_details7?void 0:_listing_details7.style)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.style}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Style"})]}),listing.listDate&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:new Date(listing.listDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"List Date"})]}),((null===(_listing_timestamps=listing.timestamps)||void 0===_listing_timestamps?void 0:_listing_timestamps.listingUpdated)||listing.updatedOn)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:new Date((null===(_listing_timestamps1=listing.timestamps)||void 0===_listing_timestamps1?void 0:_listing_timestamps1.listingUpdated)||listing.updatedOn).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Last Updated"})]})]})})]}),(0,jsx_runtime.jsxs)("details",{className:"border-b border-gray-200",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Interior Features"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsx)("div",{className:"px-7 py-6 bg-white",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[void 0!==displayBeds&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:displayBeds}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Total Bedrooms"})]}),void 0!==displayBaths&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:displayBaths}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Total Bathrooms"})]}),void 0!==(null===(_listing_details8=listing.details)||void 0===_listing_details8?void 0:_listing_details8.numBedroomsPlus)&&listing.details.numBedroomsPlus>0&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.numBedroomsPlus}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Additional Rooms"})]}),(null===(_listing_details9=listing.details)||void 0===_listing_details9?void 0:_listing_details9.numFireplaces)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:"N"===listing.details.numFireplaces?"No":listing.details.numFireplaces}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Fireplaces"})]}),(null===(_listing_details10=listing.details)||void 0===_listing_details10?void 0:_listing_details10.basement1)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.basement1}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Basement"})]})]})})]}),((null===(_listing_details11=listing.details)||void 0===_listing_details11?void 0:_listing_details11.heating)||(null===(_listing_details12=listing.details)||void 0===_listing_details12?void 0:_listing_details12.airConditioning))&&(0,jsx_runtime.jsxs)("details",{className:"border-b border-gray-200",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Heating & Cooling"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsx)("div",{className:"px-7 py-6 bg-white",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(null===(_listing_details13=listing.details)||void 0===_listing_details13?void 0:_listing_details13.heating)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.heating}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Heating Type"})]}),(null===(_listing_details14=listing.details)||void 0===_listing_details14?void 0:_listing_details14.airConditioning)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.airConditioning}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Air Conditioning"})]})]})})]}),((null===(_listing_details15=listing.details)||void 0===_listing_details15?void 0:_listing_details15.numGarageSpaces)||(null===(_listing_details16=listing.details)||void 0===_listing_details16?void 0:_listing_details16.numParkingSpaces))&&(0,jsx_runtime.jsxs)("details",{className:"border-b border-gray-200",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Parking & Garage"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsx)("div",{className:"px-7 py-6 bg-white",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[void 0!==(null===(_listing_details17=listing.details)||void 0===_listing_details17?void 0:_listing_details17.numParkingSpaces)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.numParkingSpaces}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Total Parking Spaces"})]}),void 0!==(null===(_listing_details18=listing.details)||void 0===_listing_details18?void 0:_listing_details18.numGarageSpaces)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.numGarageSpaces}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Garage Spaces"})]})]})})]}),(0,jsx_runtime.jsxs)("details",{className:"border-b border-gray-200",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Exterior & Lot"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsxs)("div",{className:"px-7 py-6 bg-white",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[displayYearBuilt&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:displayYearBuilt}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Year Built"})]}),(null===(_listing_details19=listing.details)||void 0===_listing_details19?void 0:_listing_details19.roofMaterial)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.details.roofMaterial}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Roof Material"})]}),((null===(_listing_details20=listing.details)||void 0===_listing_details20?void 0:_listing_details20.exteriorConstruction1)||(null===(_listing_details21=listing.details)||void 0===_listing_details21?void 0:_listing_details21.exteriorConstruction2))&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:[null===(_listing_details22=listing.details)||void 0===_listing_details22?void 0:_listing_details22.exteriorConstruction1,null===(_listing_details23=listing.details)||void 0===_listing_details23?void 0:_listing_details23.exteriorConstruction2].filter(Boolean).join(", ")}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Exterior"})]}),(null===(_listing_lot=listing.lot)||void 0===_listing_lot?void 0:_listing_lot.size)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.lot.size}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Lot Size"})]})]}),((null===(_listing_condominium1=listing.condominium)||void 0===_listing_condominium1||null===(_listing_condominium_amenities=_listing_condominium1.amenities)||void 0===_listing_condominium_amenities?void 0:_listing_condominium_amenities.length)>0||(null===(_listing_nearby=listing.nearby)||void 0===_listing_nearby||null===(_listing_nearby_amenities=_listing_nearby.amenities)||void 0===_listing_nearby_amenities?void 0:_listing_nearby_amenities.length)>0)&&(0,jsx_runtime.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(null===(_listing_condominium2=listing.condominium)||void 0===_listing_condominium2||null===(_listing_condominium_amenities1=_listing_condominium2.amenities)||void 0===_listing_condominium_amenities1?void 0:_listing_condominium_amenities1.length)>0&&(0,jsx_runtime.jsxs)("div",{className:"mb-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"BUILDING AMENITIES"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-2",children:listing.condominium.amenities.map(((amenity,idx)=>(0,jsx_runtime.jsx)("span",{className:"px-3 py-1.5 bg-blue-50 border border-blue-200 rounded-full text-sm text-blue-700 font-medium",children:amenity},idx)))})]}),(null===(_listing_nearby1=listing.nearby)||void 0===_listing_nearby1||null===(_listing_nearby_amenities1=_listing_nearby1.amenities)||void 0===_listing_nearby_amenities1?void 0:_listing_nearby_amenities1.length)>0&&(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"NEARBY"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-2",children:listing.nearby.amenities.map(((amenity,idx)=>(0,jsx_runtime.jsx)("span",{className:"px-3 py-1.5 bg-green-50 border border-green-200 rounded-full text-sm text-green-700 font-medium",children:amenity},idx)))})]})]})]})]}),(0,jsx_runtime.jsxs)("details",{className:"border-b-0",open:!0,children:[(0,jsx_runtime.jsxs)("summary",{className:"px-7 py-6 bg-white text-lg font-semibold text-gray-800 cursor-pointer hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Listing Information"}),(0,jsx_runtime.jsx)("span",{className:"text-xs text-gray-500",children:"▼"})]}),(0,jsx_runtime.jsx)("div",{className:"px-7 py-6 bg-white",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(null===(_listing_office=listing.office)||void 0===_listing_office?void 0:_listing_office.brokerageName)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.office.brokerageName}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Brokerage"})]}),listing.mlsNumber&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.mlsNumber}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"MLS® Number"})]}),(null===(_listing_taxes1=listing.taxes)||void 0===_listing_taxes1?void 0:_listing_taxes1.annualAmount)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:formatPrice(listing.taxes.annualAmount)}),(0,jsx_runtime.jsxs)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:["Annual Property Tax (",listing.taxes.assessmentYear,")"]})]}),(null===(_listing_condominium3=listing.condominium)||void 0===_listing_condominium3||null===(_listing_condominium_fees1=_listing_condominium3.fees)||void 0===_listing_condominium_fees1?void 0:_listing_condominium_fees1.maintenance)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsxs)("div",{className:"text-gray-900 font-semibold text-base",children:[formatPrice(listing.condominium.fees.maintenance),"/mo"]}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Condo Fees"})]}),(null===(_listing_condominium4=listing.condominium)||void 0===_listing_condominium4?void 0:_listing_condominium4.propertyMgr)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"text-gray-900 font-semibold text-base",children:listing.condominium.propertyMgr}),(0,jsx_runtime.jsx)("div",{className:"text-gray-600 text-xs tracking-wide uppercase",children:"Property Manager"})]})]})})]})]})]}),(listing.listDate||daysOnMarket)&&(0,jsx_runtime.jsxs)("div",{className:"mb-10",children:[(0,jsx_runtime.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 pb-3 border-b-2 border-gray-200",children:"Sale & Tax History"}),(0,jsx_runtime.jsxs)("div",{className:"relative pl-10",children:[(0,jsx_runtime.jsx)("div",{className:"absolute left-2 top-2 bottom-2 w-0.5 bg-gray-200"}),daysOnMarket&&(0,jsx_runtime.jsxs)("div",{className:"relative pb-8",children:[(0,jsx_runtime.jsx)("div",{className:"absolute left-[-30px] top-[10px] w-[18px] h-[18px] bg-green-500 border-[3px] border-white rounded-full shadow-[0_0_0_3px_#c6f6d5]"}),(0,jsx_runtime.jsxs)("div",{className:"pl-5",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-gray-400 mb-1 font-medium",children:"Currently"}),(0,jsx_runtime.jsx)("div",{className:"text-base text-gray-900 font-semibold mb-1",children:"Active Listing"}),(0,jsx_runtime.jsxs)("div",{className:"text-sm text-gray-600",children:[daysOnMarket," days on market"]})]})]}),((null===(_listing_timestamps2=listing.timestamps)||void 0===_listing_timestamps2?void 0:_listing_timestamps2.listingUpdated)||listing.updatedOn)&&(0,jsx_runtime.jsxs)("div",{className:"relative pb-8",children:[(0,jsx_runtime.jsx)("div",{className:"absolute left-[-30px] top-[10px] w-[18px] h-[18px] bg-blue-500 border-[3px] border-white rounded-full shadow-[0_0_0_3px_#e2e8f0]"}),(0,jsx_runtime.jsxs)("div",{className:"pl-5",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-gray-400 mb-1 font-medium",children:new Date((null===(_listing_timestamps3=listing.timestamps)||void 0===_listing_timestamps3?void 0:_listing_timestamps3.listingUpdated)||listing.updatedOn).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,jsx_runtime.jsx)("div",{className:"text-base text-gray-900 font-semibold mb-1",children:"Status Update"}),(0,jsx_runtime.jsxs)("div",{className:"text-sm text-gray-600",children:["Listed as ",propertyStatus||"Active"]})]})]}),listing.listDate&&(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)("div",{className:"absolute left-[-30px] top-[10px] w-[18px] h-[18px] bg-blue-500 border-[3px] border-white rounded-full shadow-[0_0_0_3px_#e2e8f0]"}),(0,jsx_runtime.jsxs)("div",{className:"pl-5",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-gray-400 mb-1 font-medium",children:new Date(listing.listDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,jsx_runtime.jsx)("div",{className:"text-base text-gray-900 font-semibold mb-1",children:"Listed For Sale"}),displayPrice&&(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-600",children:formatPrice(displayPrice)})]})]})]})]})]})})]})}function PropertyListingsGrid({listings,onPropertyClick}){return listings&&0!==listings.length?(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-between",children:(0,jsx_runtime.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[listings.length," ",1===listings.length?"Property":"Properties"]})}),(0,jsx_runtime.jsx)("div",{className:" grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 ",children:listings.map((listing=>(0,jsx_runtime.jsx)(PropertyCard,{listing,onViewDetails:onPropertyClick},listing.mlsNumber)))})]}):(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,jsx_runtime.jsx)("p",{className:"text-gray-500",children:"No properties to display"})})}function PropertyPanel({isOpen,onClose,mode,selectedProperty,allListings,onPropertyClick,chatPanelWidth="500px"}){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(AnimatePresence.M,{children:isOpen&&(0,jsx_runtime.jsx)(proxy.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-30 md:hidden",onClick:onClose})}),(0,jsx_runtime.jsx)(AnimatePresence.M,{children:isOpen&&(0,jsx_runtime.jsxs)(proxy.E.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed left-0 top-0 h-full z-40 bg-white shadow-2xl flex flex-col overflow-hidden w-full md:w-auto",style:{right:`max(0px, min(100vw, ${chatPanelWidth}))`},children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-white",children:[(0,jsx_runtime.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"detail"===mode?"Property Details":"All Listings"}),(0,jsx_runtime.jsx)("button",{onClick:onClose,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close property panel",children:(0,jsx_runtime.jsx)(x.Z,{className:"w-5 h-5 text-gray-600"})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["detail"===mode&&selectedProperty&&(0,jsx_runtime.jsx)("div",{className:"p-6",children:(0,jsx_runtime.jsx)(PropertyDetailsView,{listing:selectedProperty})}),"grid"===mode&&allListings.length>0&&(0,jsx_runtime.jsx)("div",{className:"p-6",children:(0,jsx_runtime.jsx)(PropertyListingsGrid,{listings:allListings,onPropertyClick})}),!mode&&(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,jsx_runtime.jsx)("p",{className:"text-gray-400",children:"No property selected"})})]})]})})]})}PropertyDetailsView.__docgenInfo={description:"PropertyDetailsView Component\n\nBeautiful property details display with hero gallery, organized sections,\nand comprehensive property information following Repliers best practices.",methods:[],displayName:"PropertyDetailsView",props:{listing:{required:!0,tsType:{name:"PropertyListing"},description:""}}},PropertyListingsGrid.__docgenInfo={description:'PropertyListingsGrid Component\n\nDisplays all property listings in a responsive grid layout.\nUsed in the PropertyPanel when showing "all listings" view.\n\nFeatures:\n- Responsive grid (1-3 columns based on screen size)\n- Clickable property cards\n- Empty state handling\n- Property count header',methods:[],displayName:"PropertyListingsGrid",props:{listings:{required:!0,tsType:{name:"Array",elements:[{name:"PropertyListing"}],raw:"PropertyListing[]"},description:""},onPropertyClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(property: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"property"}],return:{name:"void"}}},description:""}}},PropertyPanel.__docgenInfo={description:'PropertyPanel Component\n\nDisplays property information in two modes:\n- "detail": Show detailed information for a single property\n- "grid": Show grid of all available properties\n\nSlides in from the left, fills remaining space beside chat panel.\n\nFeatures:\n- Independent close button (doesn\'t close chat)\n- Two display modes\n- Responsive: overlay on mobile, side-by-side on desktop',methods:[],displayName:"PropertyPanel",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"union",raw:'"detail" | "grid" | null',elements:[{name:"literal",value:'"detail"'},{name:"literal",value:'"grid"'},{name:"null"}]},description:""},selectedProperty:{required:!0,tsType:{name:"union",raw:"PropertyListing | null",elements:[{name:"PropertyListing"},{name:"null"}]},description:""},allListings:{required:!0,tsType:{name:"Array",elements:[{name:"PropertyListing"}],raw:"PropertyListing[]"},description:""},onPropertyClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(property: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"property"}],return:{name:"void"}}},description:""},chatPanelWidth:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"500px"',computed:!1}}}};var repliersAPI_console=__webpack_require__("./node_modules/console-browserify/index.js");function normalizeListingData(raw){var _raw_details,_raw_details1,_raw_details2,_raw_details3,_raw_details4;let sqft;if(null===(_raw_details=raw.details)||void 0===_raw_details?void 0:_raw_details.sqft){const sqftStr=raw.details.sqft.replace(/[^0-9-]/g,"");if(sqftStr.includes("-")){const[min,max]=sqftStr.split("-").map(Number);sqft=Math.round((min+max)/2)}else sqft=parseInt(sqftStr,10)}const formattedImages=raw.images;return{...raw,images:formattedImages,bedrooms:(null===(_raw_details1=raw.details)||void 0===_raw_details1?void 0:_raw_details1.numBedrooms)||0,bathrooms:(null===(_raw_details2=raw.details)||void 0===_raw_details2?void 0:_raw_details2.numBathrooms)||0,sqft,propertyType:null===(_raw_details3=raw.details)||void 0===_raw_details3?void 0:_raw_details3.propertyType,status:raw.standardStatus,description:null===(_raw_details4=raw.details)||void 0===_raw_details4?void 0:_raw_details4.description,daysOnMarket:raw.simpleDaysOnMarket||raw.daysOnMarket}}class RepliersNLPService{async processQuery(prompt){repliersAPI_console.group("🧠 Repliers NLP API Call"),repliersAPI_console.log("Prompt:",prompt),repliersAPI_console.log("Current nlpId:",this.currentNlpId||"none (new conversation)");try{const requestBody={prompt,...this.currentNlpId&&{nlpId:this.currentNlpId}};repliersAPI_console.log("Request body:",JSON.stringify(requestBody,null,2));const response=await fetch(`${this.baseUrl}/nlp`,{method:"POST",headers:{"Content-Type":"application/json","repliers-api-key":this.apiKey},body:JSON.stringify(requestBody)});if(repliersAPI_console.log("Response status:",response.status),!response.ok){if(406===response.status)throw repliersAPI_console.error("❌ Query not relevant to property search (406)"),repliersAPI_console.groupEnd(),new Error("IRRELEVANT_QUERY");throw repliersAPI_console.error(`❌ NLP API error: ${response.status}`),repliersAPI_console.groupEnd(),new Error(`NLP API error: ${response.status}`)}const data=await response.json();return this.currentNlpId=data.nlpId,repliersAPI_console.log("✅ NLP Response:"),repliersAPI_console.log("Full response:",JSON.stringify(data,null,2)),repliersAPI_console.log("  - nlpId:",data.nlpId),repliersAPI_console.log("  - summary:",data.summary),repliersAPI_console.log("  - url:",data.request.url),data.request.body?(repliersAPI_console.log("  - body:",JSON.stringify(data.request.body,null,2)),data.request.body.imageSearchItems&&repliersAPI_console.log("  - imageSearchItems:",data.request.body.imageSearchItems)):repliersAPI_console.log("  - body: none"),repliersAPI_console.groupEnd(),data}catch(error){throw repliersAPI_console.error("❌ NLP processing error:",error),repliersAPI_console.groupEnd(),error}}async searchListings(url,body){const fullUrl=url.includes("?")?`${url}&select=*`:`${url}?select=*`;repliersAPI_console.group("🏠 Repliers Listings API Call"),repliersAPI_console.log("URL:",fullUrl),repliersAPI_console.log("Body:",body?JSON.stringify(body,null,2):"none");try{const response=await fetch(fullUrl,{method:body?"POST":"GET",headers:{"Content-Type":"application/json","repliers-api-key":this.apiKey},...body&&{body:JSON.stringify(body)}});if(repliersAPI_console.log("Response status:",response.status),!response.ok)throw repliersAPI_console.error(`❌ Listings API error: ${response.status}`),repliersAPI_console.groupEnd(),new Error(`Listings API error: ${response.status}`);const rawListings=(await response.json()).listings||[];if(repliersAPI_console.log(`✅ Found ${rawListings.length} properties`),rawListings.length>0){var _normalized_images;const normalized=normalizeListingData(rawListings[0]);repliersAPI_console.log("First listing:",{mlsNumber:normalized.mlsNumber,price:normalized.listPrice,bedrooms:normalized.bedrooms,address:`${normalized.address.streetNumber} ${normalized.address.streetName}, ${normalized.address.city}`,imageCount:(null===(_normalized_images=normalized.images)||void 0===_normalized_images?void 0:_normalized_images.length)||0})}return repliersAPI_console.groupEnd(),rawListings.map(normalizeListingData)}catch(error){throw repliersAPI_console.error("❌ Listings search error:",error),repliersAPI_console.groupEnd(),error}}resetContext(){repliersAPI_console.log("🔄 Resetting conversation context (clearing nlpId)"),this.currentNlpId=null}getCurrentNlpId(){return this.currentNlpId}constructor(apiKey){this.baseUrl="https://api.repliers.io",this.currentNlpId=null,this.apiKey=apiKey}}var openaiService_console=__webpack_require__("./node_modules/console-browserify/index.js");class OpenAIService{createSystemPrompt(brokerageName){return`You are a helpful and friendly real estate assistant for ${brokerageName}.\n\nYour role:\n- Help users find their ideal property through natural conversation\n- Ask clarifying questions about their needs (bedrooms, budget, location, features, amenities)\n- **IMPORTANT**: Early on, determine if they want to BUY or RENT\n- Gather as much relevant information as you can without being pushy (2-3 questions max)\n- When you have enough information, use the search_properties tool with a natural language query\n- After showing results, help users refine their search or discuss specific properties\n- When users want to refine (add filters, change criteria), trigger a NEW search with updated query\n- Be warm, professional, and focused on helping them find a home\n\nSearch Strategy:\n- DON'T extract structured parameters - let the AI search engine handle that\n- DO create a natural, conversational search query with all the details\n- **CRITICAL**: ALWAYS include "for sale" OR "for rent"/"for lease" in EVERY query - NEVER omit this\n- Include: buy/rent intent, location, bedrooms, bathrooms, price, property type, features, amenities\n- Example good query: "horse farm for sale outside Toronto with a barn or stable"\n- Example good query: "3 bedroom condo for sale in Toronto under $800k"\n- Example good query: "house for rent with a pool and wine cellar in Orlando"\n- Example BAD query: "3 bedroom condo in Toronto" (missing "for sale" or "for rent")\n\nRefinement Strategy:\n- When user wants to refine (e.g., "under $800k", "with a pool", "in different area"), IMMEDIATELY trigger a new search\n- Combine the original search criteria with the new refinement\n- **CRITICAL**: Always maintain "for sale" or "for rent" in refined queries\n- Example: Previous search was "3 bedroom condo for sale in Toronto", user says "under $800k" → Search: "3 bedroom condo for sale in Toronto under $800k"\n- Don't just discuss - actually search again with the refined criteria\n\nConversation Flow:\n1. Greet and ask: buy or rent?\n2. Ask about location and basic needs (bedrooms, price range)\n3. Ask if there are any special features or amenities they want\n4. When you have enough info (usually 2-3 exchanges), search with a natural language query\n5. After results, if user refines criteria → immediately search again with updated query\n6. Keep responses concise (2-3 sentences max) - this is a chat interface\n\nExample conversations:\nUser: "Hi"\nYou: "Hello! I'm here to help you find your perfect property. Are you looking to buy or rent?"\n\nUser: "I want to buy a 3 bedroom condo"\nYou: "Great! Where would you like to search, and do you have a budget in mind?"\n\nUser: "Toronto"\nYou: [Call search_properties with query: "3 bedroom condo for sale in Toronto"]\n     "Perfect! Let me find 3 bedroom condos for sale in Toronto."\n\n[After results are shown]\nUser: "Under $800k"\nYou: [Call search_properties with query: "3 bedroom condo for sale in Toronto under $800k"]\n     "Let me refine that search to condos under $800k."\n\nUser: "I'm looking for a horse farm"\nYou: "Wonderful! Are you looking to buy or rent, and where would you like to search?"\n\nUser: "Buy, outside Toronto. Need a barn or stable"\nYou: [Call search_properties with query: "horse farm for sale outside Toronto with barn or stable"]\n     "Great! Let me search for horse farms for sale outside Toronto with barns or stables."`}initializeConversation(){this.conversationHistory=[{role:"system",content:this.systemPrompt}]}addPropertyContext(listings,query){const contextMessage=`[Property Search Results]\nQuery: "${query}"\nFound ${listings.length} properties.\n\n${listings.slice(0,3).map(((listing,i)=>`\n${i+1}. MLS #${listing.mlsNumber}\n   Price: $${listing.listPrice.toLocaleString()}\n   ${listing.bedrooms} bed, ${listing.bathrooms} bath${listing.sqft?`, ${listing.sqft} sqft`:""}\n   ${listing.address.streetNumber} ${listing.address.streetName}, ${listing.address.city}\n   Type: ${listing.propertyType||"N/A"}\n`)).join("")}\n\n${listings.length>3?`\n... and ${listings.length-3} more properties`:""}\n\nThe user can see these property cards in the chat. Acknowledge the results and offer to help them refine or discuss specific properties.`;this.conversationHistory.push({role:"system",content:contextMessage})}async chat(userMessage){openaiService_console.group("🤖 OpenAI ChatGPT API Call"),openaiService_console.log("User message:",userMessage);try{this.conversationHistory.push({role:"user",content:userMessage}),openaiService_console.log("Conversation history length:",this.conversationHistory.length),openaiService_console.log("Sending to OpenAI...");const response=await fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:"gpt-4o-mini",messages:this.conversationHistory,temperature:.7,max_tokens:150,tools:[{type:"function",function:{name:"search_properties",description:"Search for real estate listings using natural language. Use this when you have gathered enough information from the user (buy/rent, location, and any preferences). Create a complete, natural language query that includes ALL the details the user has provided.",parameters:{type:"object",properties:{query:{type:"string",description:"A complete natural language search query that includes all user requirements. Examples: '3 bedroom condo for sale in Toronto under $800k', 'horse farm for sale outside Toronto with barn or stable', 'house to rent with pool and wine cellar in Orlando'. Always include buy/rent, location, and all features/amenities mentioned."}},required:["query"]}}}]})});if(openaiService_console.log("Response status:",response.status),!response.ok)throw openaiService_console.error(`❌ OpenAI API error: ${response.status}`),openaiService_console.groupEnd(),new Error(`OpenAI API error: ${response.status}`);const choice=(await response.json()).choices[0],assistantMessage=choice.message.content||"",toolCalls=choice.message.tool_calls;if(toolCalls&&toolCalls.length>0){const searchToolCall=toolCalls.find((tc=>"search_properties"===tc.function.name));if(searchToolCall){openaiService_console.log("🔧 ChatGPT requested tool call: search_properties");const searchParams=JSON.parse(searchToolCall.function.arguments);return openaiService_console.log("Search parameters:",searchParams),this.conversationHistory.push({role:"assistant",content:assistantMessage,tool_calls:toolCalls}),openaiService_console.log("✅ ChatGPT response with search request"),openaiService_console.groupEnd(),{message:assistantMessage||"Let me search for properties...",searchParams,needsSearch:!0,toolCallId:searchToolCall.id}}}return this.conversationHistory.push({role:"assistant",content:assistantMessage}),openaiService_console.log("✅ ChatGPT response:",assistantMessage),openaiService_console.groupEnd(),{message:assistantMessage,needsSearch:!1}}catch(error){throw openaiService_console.error("❌ ChatGPT error:",error),openaiService_console.groupEnd(),error}}addSearchResults(toolCallId,listings){const result={found:listings.length,sample:listings.slice(0,3).map((l=>({mlsNumber:l.mlsNumber,price:l.listPrice,bedrooms:l.bedrooms,bathrooms:l.bathrooms,address:`${l.address.city}, ${l.address.province||""}`})))};this.conversationHistory.push({role:"tool",content:JSON.stringify(result),tool_call_id:toolCallId,name:"search_properties"}),openaiService_console.log("📊 Added search results to ChatGPT context:",result)}resetConversation(){openaiService_console.log("🔄 Resetting ChatGPT conversation"),this.initializeConversation()}getConversationHistory(){return this.conversationHistory}trimHistory(maxMessages=10){if(this.conversationHistory.length>maxMessages+1){const systemPrompt=this.conversationHistory[0],recentMessages=this.conversationHistory.slice(-maxMessages);this.conversationHistory=[systemPrompt,...recentMessages],openaiService_console.log(`📝 Trimmed conversation history to ${this.conversationHistory.length} messages`)}}constructor(apiKey,brokerageName="Real Estate Assistant"){this.baseUrl="https://api.openai.com/v1",this.conversationHistory=[],this.apiKey=apiKey,this.systemPrompt=this.createSystemPrompt(brokerageName),this.initializeConversation()}}const DEFAULT_WELCOME_MESSAGE="Hi! I'm your AI real estate assistant. Tell me what you're looking for and I'll help you find the perfect home.";var useChatRuntime_console=__webpack_require__("./node_modules/console-browserify/index.js");function Chatbot({repliersApiKey,openaiApiKey,brokerageName="Real Estate Assistant",brokerageLogo,primaryColor,position="bottom-right",width="500px"}){const[panelState,panelActions]=function usePanelState(){const[chatOpen,setChatOpen]=(0,react.useState)(!1),[propertyPanelOpen,setPropertyPanelOpen]=(0,react.useState)(!1),[propertyPanelMode,setPropertyPanelMode]=(0,react.useState)(null),[selectedProperty,setSelectedProperty]=(0,react.useState)(null),[allListings,setAllListings]=(0,react.useState)([]);return[{chatOpen,propertyPanelOpen,propertyPanelMode,selectedProperty,allListings},{openChat:(0,react.useCallback)((()=>{setChatOpen(!0)}),[]),closeChat:(0,react.useCallback)((()=>{setChatOpen(!1),setPropertyPanelOpen(!1),setPropertyPanelMode(null),setSelectedProperty(null)}),[]),toggleChat:(0,react.useCallback)((()=>{setChatOpen((prev=>{const newState=!prev;return newState||(setPropertyPanelOpen(!1),setPropertyPanelMode(null),setSelectedProperty(null)),newState}))}),[]),openPropertyDetail:(0,react.useCallback)((property=>{setSelectedProperty(property),setPropertyPanelMode("detail"),setPropertyPanelOpen(!0)}),[]),openPropertyGrid:(0,react.useCallback)((listings=>{setAllListings(listings),setPropertyPanelMode("grid"),setPropertyPanelOpen(!0),setSelectedProperty(null)}),[]),closePropertyPanel:(0,react.useCallback)((()=>{setPropertyPanelOpen(!1),setPropertyPanelMode(null),setSelectedProperty(null)}),[]),setAllListings}]}(),welcomeMessage=openaiApiKey?DEFAULT_WELCOME_MESSAGE:"Please provide your search criteria. Include location and details like:\n\n• '3 bedroom condo in Toronto'\n• 'House under $800k in Orlando'\n• '2 bedroom apartment in downtown Miami'\n• 'Waterfront property with dock in Tampa'",placeholder=openaiApiKey?"Ask me about properties...":"e.g., 3 bedroom condo in Toronto",{messages,isLoading,sendMessage}=function useChatRuntime(repliersApiKey,openaiApiKey,brokerageName="Real Estate Assistant",welcomeMessage=DEFAULT_WELCOME_MESSAGE){const nlpService=(0,react.useMemo)((()=>new RepliersNLPService(repliersApiKey)),[repliersApiKey]),chatGPT=(0,react.useMemo)((()=>openaiApiKey?new OpenAIService(openaiApiKey,brokerageName):null),[openaiApiKey,brokerageName]),[messages,setMessages]=(0,react.useState)([{id:"welcome",role:"assistant",content:welcomeMessage,timestamp:new Date}]),[isLoading,setIsLoading]=(0,react.useState)(!1),executeSearch=(0,react.useCallback)((async query=>{useChatRuntime_console.group("🔍 Executing Property Search"),useChatRuntime_console.log("Natural language query:",query),useChatRuntime_console.log("Has ChatGPT:",!!chatGPT);try{const nlpResponse=await nlpService.processQuery(query),listings=await nlpService.searchListings(nlpResponse.request.url,nlpResponse.request.body);return useChatRuntime_console.log(`✅ NLP search completed: ${listings.length} listings`),useChatRuntime_console.groupEnd(),listings}catch(error){throw useChatRuntime_console.error("❌ Search failed:",error),useChatRuntime_console.error("Error details:",error),useChatRuntime_console.groupEnd(),error}}),[nlpService,chatGPT]),handleChatGPTMessage=(0,react.useCallback)((async userMessage=>{if(!chatGPT)throw new Error("ChatGPT not initialized - should use direct NLP flow");return await chatGPT.chat(userMessage)}),[chatGPT]),sendMessage=(0,react.useCallback)((async content=>{if(!content.trim()||isLoading)return;const userMessage={id:`user-${Date.now()}`,role:"user",content:content.trim(),timestamp:new Date};setMessages((prev=>[...prev,userMessage])),setIsLoading(!0);try{if(chatGPT){const chatResponse=await handleChatGPTMessage(content);if(chatResponse.needsSearch&&chatResponse.searchParams){if(useChatRuntime_console.log("🔧 ChatGPT requested search with query:",chatResponse.searchParams.query),chatResponse.message){const gptMessage={id:`gpt-${Date.now()}`,role:"assistant",content:chatResponse.message,timestamp:new Date};setMessages((prev=>[...prev,gptMessage]))}const searchingMessage={id:`searching-${Date.now()}`,role:"assistant",content:"Searching for properties...",timestamp:new Date,isLoading:!0};setMessages((prev=>[...prev,searchingMessage]));const listings=await executeSearch(chatResponse.searchParams.query);setMessages((prev=>prev.filter((msg=>msg.id!==searchingMessage.id)))),chatResponse.toolCallId&&(chatGPT.addSearchResults(chatResponse.toolCallId,listings),chatGPT.addPropertyContext(listings,chatResponse.searchParams.query));const resultMessage={id:`result-${Date.now()}`,role:"assistant",content:`I found ${listings.length} ${1===listings.length?"property":"properties"} matching your criteria!`,propertyResults:listings.length>0?listings:void 0,timestamp:new Date};setMessages((prev=>[...prev,resultMessage]))}else{const responseMessage={id:`response-${Date.now()}`,role:"assistant",content:chatResponse.message,timestamp:new Date};setMessages((prev=>[...prev,responseMessage]))}chatGPT.trimHistory(20)}else{useChatRuntime_console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),useChatRuntime_console.log("🔧 DIRECT NLP MODE (No OpenAI Key)"),useChatRuntime_console.log("User query:",content),useChatRuntime_console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━");const isSpecific=(query=>{const lowerQuery=query.toLowerCase().trim();if(lowerQuery.length<5)return!1;if(["hello","hi","hey","help","thanks","thank you","a house","a condo","a home","property","properties","looking","want","need","search","find"].some((term=>lowerQuery===term)))return!1;const hasNumbers=/\d+/.test(query),hasPrice=/\$|dollar|k\b|million/.test(lowerQuery),hasLocation=lowerQuery.split(" ").length>=3;return hasNumbers||hasPrice||hasLocation})(content);if(useChatRuntime_console.log("Query specific enough?",isSpecific),!isSpecific){useChatRuntime_console.log("→ Showing guidance message");const guidanceMessage={id:`guidance-${Date.now()}`,role:"assistant",content:"Please provide more details for your search. Include location and criteria like:\n\n• '3 bedroom condo in Toronto'\n• 'House under $800k in Orlando'\n• '2 bedroom apartment in downtown Miami'\n• 'Waterfront property with dock in Tampa'",timestamp:new Date};return setMessages((prev=>[...prev,guidanceMessage])),void setIsLoading(!1)}useChatRuntime_console.log("→ Executing NLP search...");const searchingMessage={id:`searching-${Date.now()}`,role:"assistant",content:"Searching for properties...",timestamp:new Date,isLoading:!0};setMessages((prev=>[...prev,searchingMessage])),useChatRuntime_console.log("→ Calling executeSearch with query:",content);const listings=await executeSearch(content);useChatRuntime_console.log("→ Search returned",listings.length,"listings"),setMessages((prev=>prev.filter((msg=>msg.id!==searchingMessage.id))));const resultMessage={id:`result-${Date.now()}`,role:"assistant",content:`I found ${listings.length} ${1===listings.length?"property":"properties"} matching your criteria!`,propertyResults:listings.length>0?listings:void 0,timestamp:new Date};setMessages((prev=>[...prev,resultMessage])),useChatRuntime_console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")}}catch(error){useChatRuntime_console.error("Error processing message:",error),setMessages((prev=>prev.filter((msg=>!msg.isLoading))));const errorMessage={id:`error-${Date.now()}`,role:"assistant",content:getErrorMessage(error),timestamp:new Date,error:!0};setMessages((prev=>[...prev,errorMessage]))}finally{setIsLoading(!1)}}),[isLoading,handleChatGPTMessage,executeSearch,chatGPT]),resetConversation=(0,react.useCallback)((()=>{nlpService.resetContext(),chatGPT&&chatGPT.resetConversation(),setMessages([{id:"welcome",role:"assistant",content:welcomeMessage,timestamp:new Date}]),setIsLoading(!1)}),[nlpService,chatGPT,welcomeMessage]);return{messages,isLoading,sendMessage,resetConversation}}(repliersApiKey,openaiApiKey,brokerageName,welcomeMessage);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(FloatingChatButton,{isOpen:panelState.chatOpen,onClick:panelActions.toggleChat,position}),(0,jsx_runtime.jsx)(ChatPanel,{isOpen:panelState.chatOpen,onClose:panelActions.closeChat,messages,isLoading,onSendMessage:sendMessage,placeholder,onPropertyClick:panelActions.openPropertyDetail,onShowAllListings:panelActions.openPropertyGrid,width,mode:openaiApiKey?"copilot":"nlp"}),(0,jsx_runtime.jsx)(PropertyPanel,{isOpen:panelState.propertyPanelOpen,onClose:panelActions.closePropertyPanel,mode:panelState.propertyPanelMode,selectedProperty:panelState.selectedProperty,allListings:panelState.allListings,onPropertyClick:panelActions.openPropertyDetail,chatPanelWidth:width})]})}Chatbot.__docgenInfo={description:'Real Estate Chatbot Component - Dual Panel UI\n\nA conversational AI chatbot with modern Claude/ChatGPT-style interface.\n\nArchitecture:\n- FloatingChatButton: Circular button in bottom right\n- ChatPanel: Slides in from right (configurable width, default 500px)\n- PropertyPanel: Slides in from left (fills remaining space)\n- Dual-panel system for chat + property details/listings\n\nFeatures:\n- Claude-style chat UI with smooth animations\n- Property details panel for selected properties\n- All listings grid view\n- Responsive: full screen mobile, side-by-side desktop\n- Independent panel close/open states\n- Configurable chat panel width\n\n@param props - The component props\n@returns JSX.Element\n\n@example\n```tsx\n<Chatbot\n  repliersApiKey="your_repliers_api_key"\n  openaiApiKey="your_openai_api_key"\n  brokerageName="Acme Realty"\n  width="600px"\n/>\n```',methods:[],displayName:"Chatbot",props:{repliersApiKey:{required:!0,tsType:{name:"string"},description:"Repliers API key (required for property search)"},openaiApiKey:{required:!1,tsType:{name:"string"},description:"OpenAI API key (optional - for enhanced conversation)"},brokerageName:{required:!1,tsType:{name:"string"},description:"Name of the brokerage to display in header",defaultValue:{value:'"Real Estate Assistant"',computed:!1}},brokerageLogo:{required:!1,tsType:{name:"string"},description:"URL to brokerage logo image"},primaryColor:{required:!1,tsType:{name:"string"},description:"Primary brand color (hex or Tailwind color)"},position:{required:!1,tsType:{name:"union",raw:'"bottom-right" | "bottom-left"',elements:[{name:"literal",value:'"bottom-right"'},{name:"literal",value:'"bottom-left"'}]},description:"Position of the floating button",defaultValue:{value:'"bottom-right"',computed:!1}},width:{required:!1,tsType:{name:"string"},description:'Width of the chat panel (e.g., "500px", "50%") - defaults to "500px"',defaultValue:{value:'"500px"',computed:!1}}}};const chatbot_stories={title:"pocs/Chatbot/Real Estate Chatbot",component:Chatbot,tags:["autodocs"],parameters:{layout:"fullscreen",docs:{description:{component:'\n# Real Estate Chatbot\n\nAn intelligent, conversational AI chatbot for real estate websites powered by Repliers NLP API\nand optional ChatGPT integration.\n\n## ✨ Features\n\n- 🗣️ **Natural Language Search** - "3 bedroom condo in Toronto under $800k"\n- 🤖 **ChatGPT Integration** - Natural conversation (optional, add OpenAI key)\n- 🔄 **Context-Aware** - Multi-turn refinement maintains conversation context\n- 🎨 **Visual Search** - Search by aesthetics: "modern white kitchen"\n- 🏠 **Beautiful UI** - Responsive property cards with images\n- 🎨 **White-Label Ready** - Customizable branding, logo, and colors\n- 📱 **Mobile Optimized** - Full-screen on mobile, panel on desktop\n\n## 🚀 Quick Start\n\n1. **Try the Working Demo** story below\n2. **(Optional)** Add your OpenAI API key for ChatGPT conversation\n3. Search: "3 bedroom condo in Toronto"\n4. Refine: "Under $800k"\n\n## 🎯 Example Queries\n\n- "3 bedroom condo in Toronto"\n- "House under $800k with a backyard"\n- "Modern apartment with white kitchen"\n- "Show me properties in the Annex"\n\n## 🔑 API Keys\n\n- **Repliers API**: Sample key provided - [get yours here](https://repliers.com)\n- **OpenAI API** (optional): For ChatGPT conversation - [get key](https://platform.openai.com)\n\n## 🔧 Integration\n\nCopy the entire `src/components/chatbot` directory into your project. All dependencies\nare self-contained for easy integration.\n\n```tsx\nimport { Chatbot } from \'@/components/chatbot\';\n\n<Chatbot\n  repliersApiKey="your-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n/>\n```\n        '}}},argTypes:{repliersApiKey:{control:"text",description:"Repliers API key (required for property search)",table:{type:{summary:"string"},defaultValue:{summary:"Sample key provided"}}},openaiApiKey:{control:"text",description:"OpenAI API key (optional - enables ChatGPT for natural conversation). Get yours at platform.openai.com",table:{type:{summary:"string"},defaultValue:{summary:"undefined (uses fallback responses)"}}},brokerageName:{control:"text",description:"Name of the brokerage to display in chat header",table:{type:{summary:"string"},defaultValue:{summary:"Real Estate Assistant"}}},brokerageLogo:{control:"text",description:"URL to brokerage logo image",table:{type:{summary:"string"}}},primaryColor:{control:"color",description:"Primary brand color (future feature)",table:{type:{summary:"string"},defaultValue:{summary:"#3B82F6"}}},position:{control:"radio",options:["bottom-right","bottom-left"],description:"Position of the floating button",table:{type:{summary:"bottom-right | bottom-left"},defaultValue:{summary:"bottom-right"}}}}},WorkingDemo={args:{repliersApiKey:"pxI19UMy9zfw9vz5lRxoGpjJWXrMnm",openaiApiKey:void 0,brokerageName:"Smart Homes Realty"},parameters:{docs:{description:{story:'\nThis is a complete, working demonstration of the chatbot with all features:\n\n- **Natural Language Search**: Ask in plain English\n- **Multi-Turn Conversations**: Refine searches with context\n- **Visual Search**: Search by aesthetics (e.g., "modern kitchen")\n- **ChatGPT Integration**: Add your OpenAI key for intelligent conversation\n- **Beautiful UI**: Responsive property cards with images\n\n**Getting Started:**\n1. Try a search query like "3 bedroom condo in Toronto"\n2. (Optional) Add your OpenAI API key for ChatGPT conversation\n3. Watch the console to see API calls in action\n        '}}}},CustomBranding={args:{repliersApiKey:"pxI19UMy9zfw9vz5lRxoGpjJWXrMnm",brokerageName:"Luxury Homes Toronto",brokerageLogo:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=100&h=100&fit=crop",primaryColor:"#1e40af",position:"bottom-right"},parameters:{docs:{description:{story:'\nCustomize every aspect of the chatbot to match your brand:\n\n**Branding Options:**\n- `brokerageName`: Your company name in the header\n- `brokerageLogo`: URL to your logo image\n- `welcomeMessage`: Custom greeting message\n- `placeholder`: Custom input placeholder text\n- `primaryColor`: Brand color (future feature)\n- `position`: "bottom-right" or "bottom-left"\n\n**Example Integration:**\n```tsx\n<Chatbot\n  repliersApiKey="your-key"\n  openaiApiKey="your-openai-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n  welcomeMessage="Welcome! How can I help you find your dream home?"\n  position="bottom-right"\n/>\n```\n        '}}}},__namedExportsOrder=["WorkingDemo","CustomBranding"];WorkingDemo.parameters={...WorkingDemo.parameters,docs:{...WorkingDemo.parameters?.docs,source:{originalSource:'{\n  args: {\n    repliersApiKey: SAMPLE_REPLIERS_API_KEY,\n    openaiApiKey: undefined,\n    // ⬅️ Paste your OpenAI API key here to enable ChatGPT!\n    brokerageName: "Smart Homes Realty"\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\nThis is a complete, working demonstration of the chatbot with all features:\n\n- **Natural Language Search**: Ask in plain English\n- **Multi-Turn Conversations**: Refine searches with context\n- **Visual Search**: Search by aesthetics (e.g., "modern kitchen")\n- **ChatGPT Integration**: Add your OpenAI key for intelligent conversation\n- **Beautiful UI**: Responsive property cards with images\n\n**Getting Started:**\n1. Try a search query like "3 bedroom condo in Toronto"\n2. (Optional) Add your OpenAI API key for ChatGPT conversation\n3. Watch the console to see API calls in action\n        `\n      }\n    }\n  }\n}',...WorkingDemo.parameters?.docs?.source},description:{story:'**Working Demo**\n\nA fully functional chatbot with NLP-powered property search.\nThis demonstrates the core functionality with all features enabled.\n\n**Try these queries:**\n- "Hello!" (if you add an OpenAI API key)\n- "3 bedroom condo in Toronto"\n- "House under $800k with a backyard"\n- "Modern apartment with white kitchen"\n- "Show me properties in the Annex"\n\n**NEW: Unique Keyword Searches:**\n- "I\'m looking for a horse farm in Orlando"\n- "House with pool and wine cellar"\n- "Property with home theater"\n- "Waterfront property with dock"\n\n**To enable ChatGPT conversation:**\nAdd your OpenAI API key in the controls below for natural, intelligent dialogue.\n\n**Check the browser console** to see API calls and keyword extraction!',...WorkingDemo.parameters?.docs?.description}}},CustomBranding.parameters={...CustomBranding.parameters,docs:{...CustomBranding.parameters?.docs,source:{originalSource:'{\n  args: {\n    repliersApiKey: SAMPLE_REPLIERS_API_KEY,\n    brokerageName: "Luxury Homes Toronto",\n    brokerageLogo: "https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=100&h=100&fit=crop",\n    primaryColor: "#1e40af",\n    position: "bottom-right"\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\nCustomize every aspect of the chatbot to match your brand:\n\n**Branding Options:**\n- \\`brokerageName\\`: Your company name in the header\n- \\`brokerageLogo\\`: URL to your logo image\n- \\`welcomeMessage\\`: Custom greeting message\n- \\`placeholder\\`: Custom input placeholder text\n- \\`primaryColor\\`: Brand color (future feature)\n- \\`position\\`: "bottom-right" or "bottom-left"\n\n**Example Integration:**\n\\`\\`\\`tsx\n<Chatbot\n  repliersApiKey="your-key"\n  openaiApiKey="your-openai-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n  welcomeMessage="Welcome! How can I help you find your dream home?"\n  position="bottom-right"\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}',...CustomBranding.parameters?.docs?.source},description:{story:"**Custom Branding**\n\nThis story shows how to white-label the chatbot with your brokerage's branding.\nCustomize the name, logo, colors, welcome message, and button position.\n\n**Perfect for:**\n- Adding to your real estate website\n- White-labeling for clients\n- Matching your brand identity",...CustomBranding.parameters?.docs?.description}}}}}]);