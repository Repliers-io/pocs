"use strict";(self.webpackChunkpocs=self.webpackChunkpocs||[]).push([[978],{"./src/components/chatbot/chatbot.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CustomBranding:()=>CustomBranding,UniqueKeywordSearches:()=>UniqueKeywordSearches,WorkingDemo:()=>WorkingDemo,__namedExportsOrder:()=>__namedExportsOrder,default:()=>chatbot_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),x=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/x.js"),message_circle=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/message-circle.js");const DEFAULT_WELCOME_MESSAGE="Hi! I'm your AI real estate assistant. Tell me what you're looking for and I'll help you find the perfect home.",BUTTON_LABELS_CHAT_WITH_US="Chat with us",BUTTON_LABELS_CLOSE="Close chat",BUTTON_LABELS_SEND="Send message";function FloatingButton({isOpen,onClick,position="bottom-right"}){return(0,jsx_runtime.jsx)("button",{onClick,"aria-label":isOpen?BUTTON_LABELS_CLOSE:BUTTON_LABELS_CHAT_WITH_US,className:`\n        fixed ${{"bottom-right":"bottom-6 right-6","bottom-left":"bottom-6 left-6"}[position]} z-50\n        flex items-center gap-3 px-6 py-4\n        bg-gradient-to-r from-blue-600 to-blue-700\n        text-white rounded-full shadow-2xl\n        hover:shadow-blue-500/50 hover:scale-105\n        active:scale-95\n        transition-all duration-300 ease-out\n        group\n      `,style:{animation:"slideUp 0.5s ease-out forwards"},children:isOpen?(0,jsx_runtime.jsx)(x.Z,{className:"w-6 h-6"}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{className:"text-2xl",role:"img","aria-label":"house",children:"üè†"}),(0,jsx_runtime.jsx)("span",{className:"font-semibold text-sm tracking-wide hidden sm:inline",children:BUTTON_LABELS_CHAT_WITH_US}),(0,jsx_runtime.jsx)(message_circle.Z,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"})]})})}if("undefined"!=typeof document){const style=document.createElement("style");style.textContent="\n    @keyframes slideUp {\n      from {\n        opacity: 0;\n        transform: translateY(20px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n  ",document.head.querySelector("style[data-chatbot-animations]")||(style.setAttribute("data-chatbot-animations","true"),document.head.appendChild(style))}FloatingButton.__docgenInfo={description:"",methods:[],displayName:"FloatingButton",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},position:{required:!1,tsType:{name:"union",raw:'"bottom-right" | "bottom-left"',elements:[{name:"literal",value:'"bottom-right"'},{name:"literal",value:'"bottom-left"'}]},description:"",defaultValue:{value:'"bottom-right"',computed:!1}}}};var loader_circle=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/loader-circle.js"),send=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/send.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");function normalizeListingData(raw){var _raw_details,_raw_details1,_raw_details2,_raw_details3,_raw_details4;let sqft;if(null===(_raw_details=raw.details)||void 0===_raw_details?void 0:_raw_details.sqft){const sqftStr=raw.details.sqft.replace(/[^0-9-]/g,"");if(sqftStr.includes("-")){const[min,max]=sqftStr.split("-").map(Number);sqft=Math.round((min+max)/2)}else sqft=parseInt(sqftStr,10)}const address={streetNumber:raw.address.streetNumber||"",streetName:raw.address.streetName||"",streetSuffix:raw.address.streetSuffix,city:raw.address.city||"",province:raw.address.province,postalCode:raw.address.postalCode};return{mlsNumber:raw.mlsNumber,listPrice:raw.listPrice,bedrooms:(null===(_raw_details1=raw.details)||void 0===_raw_details1?void 0:_raw_details1.numBedrooms)||0,bathrooms:(null===(_raw_details2=raw.details)||void 0===_raw_details2?void 0:_raw_details2.numBathrooms)||0,sqft,address,images:raw.images,propertyType:null===(_raw_details3=raw.details)||void 0===_raw_details3?void 0:_raw_details3.propertyType,status:raw.standardStatus,description:null===(_raw_details4=raw.details)||void 0===_raw_details4?void 0:_raw_details4.description,listDate:raw.listDate,daysOnMarket:raw.simpleDaysOnMarket||raw.daysOnMarket}}class RepliersNLPService{async processQuery(prompt,keywords){console.group("üß† Repliers NLP API Call"),console.log("Prompt:",prompt),console.log("Keywords:",keywords||"none"),console.log("Current nlpId:",this.currentNlpId||"none (new conversation)");try{const requestBody={prompt,...this.currentNlpId&&{nlpId:this.currentNlpId},...keywords&&keywords.length>0&&{keywords}};console.log("Request body:",JSON.stringify(requestBody,null,2));const response=await fetch(`${this.baseUrl}/nlp`,{method:"POST",headers:{"Content-Type":"application/json","repliers-api-key":this.apiKey},body:JSON.stringify(requestBody)});if(console.log("Response status:",response.status),!response.ok){if(406===response.status)throw console.error("‚ùå Query not relevant to property search (406)"),console.groupEnd(),new Error("IRRELEVANT_QUERY");throw console.error(`‚ùå NLP API error: ${response.status}`),console.groupEnd(),new Error(`NLP API error: ${response.status}`)}const data=await response.json();return this.currentNlpId=data.nlpId,console.log("‚úÖ NLP Response:"),console.log("  - nlpId:",data.nlpId),console.log("  - summary:",data.summary),console.log("  - url:",data.request.url),data.request.body?(console.log("  - body:",data.request.body),data.request.body.imageSearchItems&&console.log("  - imageSearchItems:",data.request.body.imageSearchItems),data.request.body.keywords&&console.log("  - keywords in body:",data.request.body.keywords)):console.log("  - body: none (keywords not returned by NLP)"),console.groupEnd(),data}catch(error){throw console.error("‚ùå NLP processing error:",error),console.groupEnd(),error}}async searchListings(url,body,keywords){console.group("üè† Repliers Listings API Call"),console.log("URL:",url),console.log("Initial body:",body?JSON.stringify(body,null,2):"none"),console.log("Keywords to add:",keywords||"none");let requestBody=body;keywords&&keywords.length>0&&(requestBody={...body||{},keywords:(null==body?void 0:body.keywords)||keywords},console.log("Final body with keywords:",JSON.stringify(requestBody,null,2)));try{const response=await fetch(url,{method:requestBody?"POST":"GET",headers:{"Content-Type":"application/json","repliers-api-key":this.apiKey},...requestBody&&{body:JSON.stringify(requestBody)}});if(console.log("Response status:",response.status),!response.ok)throw console.error(`‚ùå Listings API error: ${response.status}`),console.groupEnd(),new Error(`Listings API error: ${response.status}`);const rawListings=(await response.json()).listings||[];if(console.log(`‚úÖ Found ${rawListings.length} properties`),rawListings.length>0){console.log("First listing (raw API response):",rawListings[0]);const normalized=normalizeListingData(rawListings[0]);console.log("First listing (normalized for UI):",{mlsNumber:normalized.mlsNumber,price:normalized.listPrice,bedrooms:normalized.bedrooms,bathrooms:normalized.bathrooms,sqft:normalized.sqft,propertyType:normalized.propertyType,status:normalized.status,address:`${normalized.address.streetNumber} ${normalized.address.streetName}, ${normalized.address.city}`})}return console.groupEnd(),rawListings.map(normalizeListingData)}catch(error){throw console.error("‚ùå Listings search error:",error),console.groupEnd(),error}}resetContext(){console.log("üîÑ Resetting conversation context (clearing nlpId)"),this.currentNlpId=null}getCurrentNlpId(){return this.currentNlpId}constructor(apiKey){this.baseUrl="https://api.repliers.io",this.currentNlpId=null,this.apiKey=apiKey}}var client=__webpack_require__("./node_modules/@modelcontextprotocol/sdk/dist/esm/client/index.js"),sse=__webpack_require__("./node_modules/@modelcontextprotocol/sdk/dist/esm/client/sse.js"),mcpService_http_console=__webpack_require__("./node_modules/console-browserify/index.js");class RepliersMCPServiceHttp{async connect(){try{mcpService_http_console.log(`[MCP HTTP] Connecting to ${this.serverUrl}...`),this.transport=new sse.T(new URL(this.serverUrl)),this.client=new client.K({name:"repliers-chatbot-client",version:"1.0.0"},{capabilities:{}}),await this.client.connect(this.transport);const tools=await this.client.listTools();mcpService_http_console.log("[MCP HTTP] Connected! Available tools:",tools.tools.map((t=>t.name))),this.isConnected=!0}catch(error){throw mcpService_http_console.error("[MCP HTTP] Failed to connect:",error),this.isConnected=!1,error}}async disconnect(){this.client&&(await this.client.close(),this.client=null,this.transport=null,this.isConnected=!1,mcpService_http_console.log("[MCP HTTP] Disconnected"))}isReady(){return this.isConnected&&null!==this.client}async searchListings(params){if(!this.client||!this.isConnected)throw new Error("MCP client not connected");try{mcpService_http_console.log("[MCP HTTP] Calling search tool with params:",params);const result=await this.client.callTool({name:"search",arguments:params});if(mcpService_http_console.log("[MCP HTTP] Search result:",result),result.content&&result.content.length>0){const textContent=result.content.find((c=>"text"===c.type));if(textContent&&"text"in textContent)try{const data=JSON.parse(textContent.text);return this.normalizeListings(data.listings||data)}catch(e){return mcpService_http_console.error("[MCP HTTP] Failed to parse search results:",e),[]}}return[]}catch(error){throw mcpService_http_console.error("[MCP HTTP] Search failed:",error),error}}async getListing(mlsNumber){if(!this.client||!this.isConnected)throw new Error("MCP client not connected");try{mcpService_http_console.log(`[MCP HTTP] Getting listing ${mlsNumber}`);const result=await this.client.callTool({name:"get-a-listing",arguments:{mlsNumber}});if(result.content&&result.content.length>0){const textContent=result.content.find((c=>"text"===c.type));if(textContent&&"text"in textContent)try{const data=JSON.parse(textContent.text);return this.normalizeListings([data])[0]||null}catch(e){return mcpService_http_console.error("[MCP HTTP] Failed to parse listing:",e),null}}return null}catch(error){throw mcpService_http_console.error("[MCP HTTP] Get listing failed:",error),error}}async findSimilarListings(mlsNumber){if(!this.client||!this.isConnected)throw new Error("MCP client not connected");try{mcpService_http_console.log(`[MCP HTTP] Finding similar listings to ${mlsNumber}`);const result=await this.client.callTool({name:"find-similar-listings",arguments:{mlsNumber}});if(result.content&&result.content.length>0){const textContent=result.content.find((c=>"text"===c.type));if(textContent&&"text"in textContent)try{const data=JSON.parse(textContent.text);return this.normalizeListings(data.listings||data)}catch(e){return mcpService_http_console.error("[MCP HTTP] Failed to parse similar listings:",e),[]}}return[]}catch(error){throw mcpService_http_console.error("[MCP HTTP] Find similar listings failed:",error),error}}normalizeListings(rawListings){return rawListings.map((raw=>{try{var _raw_details,_raw_details1,_raw_details2,_raw_address,_raw_address1,_raw_address2,_raw_address3,_raw_address4,_raw_address5,_raw_details3,_raw_details4;return{mlsNumber:raw.mlsNumber,listPrice:raw.listPrice,bedrooms:(null===(_raw_details=raw.details)||void 0===_raw_details?void 0:_raw_details.numBedrooms)||0,bathrooms:(null===(_raw_details1=raw.details)||void 0===_raw_details1?void 0:_raw_details1.numBathrooms)||0,sqft:this.parseSqft(null===(_raw_details2=raw.details)||void 0===_raw_details2?void 0:_raw_details2.sqft),address:{streetNumber:(null===(_raw_address=raw.address)||void 0===_raw_address?void 0:_raw_address.streetNumber)||"",streetName:(null===(_raw_address1=raw.address)||void 0===_raw_address1?void 0:_raw_address1.streetName)||"",streetSuffix:null===(_raw_address2=raw.address)||void 0===_raw_address2?void 0:_raw_address2.streetSuffix,city:(null===(_raw_address3=raw.address)||void 0===_raw_address3?void 0:_raw_address3.city)||"",province:null===(_raw_address4=raw.address)||void 0===_raw_address4?void 0:_raw_address4.province,postalCode:null===(_raw_address5=raw.address)||void 0===_raw_address5?void 0:_raw_address5.postalCode},images:raw.images||[],propertyType:null===(_raw_details3=raw.details)||void 0===_raw_details3?void 0:_raw_details3.propertyType,status:raw.standardStatus||raw.status,description:null===(_raw_details4=raw.details)||void 0===_raw_details4?void 0:_raw_details4.description,listDate:raw.listDate,daysOnMarket:raw.daysOnMarket||raw.simpleDaysOnMarket}}catch(error){return mcpService_http_console.error("[MCP HTTP] Failed to normalize listing:",error),null}})).filter((listing=>null!==listing))}parseSqft(sqftString){if(!sqftString)return;const cleaned=sqftString.replace(/[^\d\-\.]/g,"");if(cleaned.includes("-")){const firstNum=cleaned.split("-")[0];return parseInt(firstNum,10)}const parsed=parseInt(cleaned,10);return isNaN(parsed)?void 0:parsed}constructor(serverUrl){this.client=null,this.transport=null,this.isConnected=!1,this.serverUrl=serverUrl}}var openaiService_console=__webpack_require__("./node_modules/console-browserify/index.js");class OpenAIService{createSystemPrompt(brokerageName){return`You are a helpful and friendly real estate assistant for ${brokerageName}.\n\nYour role:\n- Help users find their ideal property through natural conversation\n- Ask clarifying questions about their needs (bedrooms, budget, location, features)\n- **IMPORTANT**: Early on, determine if they want to BUY (type: "sale") or RENT (type: "lease")\n- When you have enough information, use the search_properties tool to find listings\n- Discuss property details, neighborhoods, and answer real estate questions\n- Be warm, professional, and focused on helping them find a home\n\nImportant:\n- ALWAYS set type to "sale" for buying or "lease" for renting (never leave it unset)\n- Use the "class" parameter for broad categorization:\n  - "condo" for condominiums/apartments\n  - "residential" for houses/townhouses/single-family homes\n  - "commercial" for commercial properties\n- Use "propertyType" for specific types like "House", "Townhouse", "Apartment"\n- **KEYWORDS**: Extract lifestyle/feature keywords that aren't captured by standard filters:\n  - Amenities: "pool", "wine cellar", "home theater", "gym", "sauna"\n  - Lifestyle: "horse farm", "equestrian", "waterfront", "golf course"\n  - Features: "fireplace", "hardwood floors", "granite counters", "stainless steel"\n  - Outdoor: "deck", "patio", "garden", "yard", "balcony"\n- Use the search_properties tool when you understand what the user wants\n- Build up search parameters from conversation (city, bedrooms, price, etc.)\n- Keep responses concise (2-3 sentences max) - this is a chat interface\n- Guide the conversation toward understanding their property needs\n\nExample conversations:\nUser: "Hi"\nYou: "Hello! I'm here to help you find your perfect property. Are you looking to buy or rent?"\n\nUser: "I want to buy a 3 bedroom condo"\nYou: "Great! Where would you like to search?"\n\nUser: "Toronto under $800k"\nYou: [Call search_properties with city: "Toronto", bedrooms: 3, maxPrice: 800000, class: "condo", type: "sale"]\n     "Perfect! Let me find 3 bedroom condos for sale in Toronto under $800k for you."\n\nUser: "I'm looking for a horse farm in Orlando"\nYou: [Call search_properties with city: "Orlando", type: "sale", keywords: ["horse", "farm", "equestrian", "stable", "barn"]]\n     "Great! Let me search for horse farms and equestrian properties for sale in Orlando."\n\nUser: "House with pool and wine cellar"\nYou: [Call search_properties with type: "sale", class: "residential", keywords: ["pool", "wine cellar"]]\n     "I'll find houses with pools and wine cellars for you! What's your preferred location?"`}initializeConversation(){this.conversationHistory=[{role:"system",content:this.systemPrompt}]}addPropertyContext(listings,query){const contextMessage=`[Property Search Results]\nQuery: "${query}"\nFound ${listings.length} properties.\n\n${listings.slice(0,3).map(((listing,i)=>`\n${i+1}. MLS #${listing.mlsNumber}\n   Price: $${listing.listPrice.toLocaleString()}\n   ${listing.bedrooms} bed, ${listing.bathrooms} bath${listing.sqft?`, ${listing.sqft} sqft`:""}\n   ${listing.address.streetNumber} ${listing.address.streetName}, ${listing.address.city}\n   Type: ${listing.propertyType||"N/A"}\n`)).join("")}\n\n${listings.length>3?`\n... and ${listings.length-3} more properties`:""}\n\nThe user can see these property cards in the chat. Acknowledge the results and offer to help them refine or discuss specific properties.`;this.conversationHistory.push({role:"system",content:contextMessage})}async chat(userMessage){openaiService_console.group("ü§ñ OpenAI ChatGPT API Call"),openaiService_console.log("User message:",userMessage);try{this.conversationHistory.push({role:"user",content:userMessage}),openaiService_console.log("Conversation history length:",this.conversationHistory.length),openaiService_console.log("Sending to OpenAI...");const response=await fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:"gpt-4o-mini",messages:this.conversationHistory,temperature:.7,max_tokens:150,tools:[{type:"function",function:{name:"search_properties",description:"Search for real estate listings based on user criteria. Use this when the user provides enough information to search (location, price, bedrooms, etc.)",parameters:{type:"object",properties:{city:{type:"string",description:"City name (e.g., 'Toronto', 'Vancouver')"},province:{type:"string",description:"Province/state code (e.g., 'ON', 'BC', 'CA')"},minPrice:{type:"number",description:"Minimum price in dollars"},maxPrice:{type:"number",description:"Maximum price in dollars"},bedrooms:{type:"number",description:"Number of bedrooms"},bathrooms:{type:"number",description:"Number of bathrooms"},propertyType:{type:"string",description:"Property type (e.g., 'Condo', 'House', 'Townhouse', 'Apartment')"},type:{type:"string",enum:["sale","lease"],description:"REQUIRED: Use 'sale' for buying, 'lease' for renting. Never leave unset."},class:{type:"string",enum:["condo","residential","commercial"],description:"Broad property classification: 'condo' for condominiums, 'residential' for houses/townhouses, 'commercial' for commercial properties"},keywords:{type:"array",items:{type:"string"},description:"Lifestyle/feature keywords for unique property characteristics not covered by standard filters. Examples: ['pool', 'wine cellar'], ['horse', 'farm', 'equestrian'], ['waterfront', 'dock'], ['home theater'], ['fireplace', 'hardwood floors']. Extract ALL relevant amenities, features, and lifestyle terms from user's query."}},required:[]}}}]})});if(openaiService_console.log("Response status:",response.status),!response.ok)throw openaiService_console.error(`‚ùå OpenAI API error: ${response.status}`),openaiService_console.groupEnd(),new Error(`OpenAI API error: ${response.status}`);const choice=(await response.json()).choices[0],assistantMessage=choice.message.content||"",toolCalls=choice.message.tool_calls;if(toolCalls&&toolCalls.length>0){const searchToolCall=toolCalls.find((tc=>"search_properties"===tc.function.name));if(searchToolCall){openaiService_console.log("üîß ChatGPT requested tool call: search_properties");const searchParams=JSON.parse(searchToolCall.function.arguments);return openaiService_console.log("Search parameters:",searchParams),this.conversationHistory.push({role:"assistant",content:assistantMessage,tool_calls:toolCalls}),openaiService_console.log("‚úÖ ChatGPT response with search request"),openaiService_console.groupEnd(),{message:assistantMessage||"Let me search for properties...",searchParams,needsSearch:!0,toolCallId:searchToolCall.id}}}return this.conversationHistory.push({role:"assistant",content:assistantMessage}),openaiService_console.log("‚úÖ ChatGPT response:",assistantMessage),openaiService_console.groupEnd(),{message:assistantMessage,needsSearch:!1}}catch(error){throw openaiService_console.error("‚ùå ChatGPT error:",error),openaiService_console.groupEnd(),error}}addSearchResults(toolCallId,listings){const result={found:listings.length,sample:listings.slice(0,3).map((l=>({mlsNumber:l.mlsNumber,price:l.listPrice,bedrooms:l.bedrooms,bathrooms:l.bathrooms,address:`${l.address.city}, ${l.address.province||""}`})))};this.conversationHistory.push({role:"tool",content:JSON.stringify(result),tool_call_id:toolCallId,name:"search_properties"}),openaiService_console.log("üìä Added search results to ChatGPT context:",result)}resetConversation(){openaiService_console.log("üîÑ Resetting ChatGPT conversation"),this.initializeConversation()}getConversationHistory(){return this.conversationHistory}trimHistory(maxMessages=10){if(this.conversationHistory.length>maxMessages+1){const systemPrompt=this.conversationHistory[0],recentMessages=this.conversationHistory.slice(-maxMessages);this.conversationHistory=[systemPrompt,...recentMessages],openaiService_console.log(`üìù Trimmed conversation history to ${this.conversationHistory.length} messages`)}}constructor(apiKey,brokerageName="Real Estate Assistant"){this.baseUrl="https://api.openai.com/v1",this.conversationHistory=[],this.apiKey=apiKey,this.systemPrompt=this.createSystemPrompt(brokerageName),this.initializeConversation()}}function getErrorMessage(error){if(error instanceof Error){if("IRRELEVANT_QUERY"===error.message)return"I can help you find properties! Try asking about homes, condos, or apartments for sale. For example: '3 bedroom condo in Toronto' or 'house under $800k'.";if(error.message.includes("API error"))return"Sorry, I'm having trouble connecting to the property search service. Please try again in a moment.";if(error.message.includes("401")||error.message.includes("403"))return"There's an issue with the API configuration. Please contact support.";if(error.message.includes("timeout"))return"The search is taking longer than expected. Please try again."}return"Sorry, something went wrong. Please try again or rephrase your search."}function formatAddress(address){return`${[address.streetNumber,address.streetName,address.streetSuffix].filter(Boolean).join(" ")}, ${[address.city,address.province].filter(Boolean).join(", ")}`}var useChatRuntime_console=__webpack_require__("./node_modules/console-browserify/index.js");var house=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/house.js"),chevron_up=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-up.js"),chevron_down=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-down.js"),bed=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/bed.js"),bath=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/bath.js"),maximize_2=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/maximize-2.js");function PropertyCard({listing,onViewDetails}){var _listing_images;const[imageLoaded,setImageLoaded]=(0,react.useState)(!1),[imageError,setImageError]=(0,react.useState)(!1),imageUrl=function getImageUrl(imageUrl){if(!imageUrl)return;let fullUrl=imageUrl;imageUrl.startsWith("http://")||imageUrl.startsWith("https://")||(fullUrl=`https://cdn.repliers.io/${imageUrl.startsWith("/")?imageUrl.slice(1):imageUrl}`);if(fullUrl.includes("class="))return fullUrl;const separator=fullUrl.includes("?")?"&":"?";return`${fullUrl}${separator}class=small`}(null===(_listing_images=listing.images)||void 0===_listing_images?void 0:_listing_images[0]),showImage=imageUrl&&!imageError,propertySummary=function getPropertySummary(listing){const type=listing.propertyType||"property",address=formatAddress(listing.address);return`${listing.bedrooms} bedroom, ${listing.bathrooms} bathroom ${type} at ${address}`}(listing),handleClick=()=>{onViewDetails?onViewDetails(listing):alert(`Property details:\nMLS #${listing.mlsNumber}\n\nFull details view coming soon!`)};return(0,jsx_runtime.jsxs)("div",{className:" bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300 ease-out cursor-pointer focus-within:ring-2 focus-within:ring-blue-500 ",onClick:handleClick,onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),handleClick())},tabIndex:0,role:"button","aria-label":`View details for ${propertySummary}`,children:[(0,jsx_runtime.jsxs)("div",{className:"relative h-40 bg-gray-200 overflow-hidden",children:[showImage?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!imageLoaded&&(0,jsx_runtime.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,jsx_runtime.jsx)("div",{className:"w-10 h-10 border-3 border-gray-300 border-t-blue-600 rounded-full animate-spin"})}),(0,jsx_runtime.jsx)("img",{src:imageUrl,alt:`Property at ${formatAddress(listing.address)}`,className:`\n                w-full h-full object-cover\n                transition-opacity duration-300\n                ${imageLoaded?"opacity-100":"opacity-0"}\n              `,onLoad:()=>setImageLoaded(!0),onError:()=>setImageError(!0),loading:"lazy"})]}):(0,jsx_runtime.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:(0,jsx_runtime.jsx)(house.Z,{className:"w-12 h-12 text-gray-400"})}),listing.propertyType&&(0,jsx_runtime.jsx)("div",{className:"absolute top-2 left-2 bg-white/90 backdrop-blur-sm px-2 py-0.5 rounded-full text-[10px] font-semibold text-gray-700 shadow-md",children:listing.propertyType}),listing.status&&(0,jsx_runtime.jsx)("div",{className:"absolute top-2 right-2 bg-blue-600 text-white px-2 py-0.5 rounded-full text-[10px] font-semibold shadow-md",children:listing.status})]}),(0,jsx_runtime.jsxs)("div",{className:"p-3 space-y-2",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-0.5",children:[(0,jsx_runtime.jsx)("div",{className:"text-xl font-bold text-gray-900",children:(price=listing.listPrice,new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(price))}),(0,jsx_runtime.jsxs)("div",{className:"text-[10px] text-gray-500",children:["MLS #",listing.mlsNumber]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Bedrooms",children:[(0,jsx_runtime.jsx)(bed.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.bedrooms})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Bathrooms",children:[(0,jsx_runtime.jsx)(bath.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.bathrooms})]}),listing.sqft&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",title:"Square footage",children:[(0,jsx_runtime.jsx)(maximize_2.Z,{className:"w-3.5 h-3.5"}),(0,jsx_runtime.jsx)("span",{className:"text-xs font-medium",children:listing.sqft.toLocaleString()})]})]}),(0,jsx_runtime.jsx)("div",{className:"text-xs text-gray-700 pt-1 border-t border-gray-100",children:formatAddress(listing.address)}),(0,jsx_runtime.jsxs)("button",{className:" w-full mt-1.5 py-1.5 px-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white text-xs font-semibold rounded-lg hover:from-blue-700 hover:to-blue-800 active:scale-95 transition-all duration-200 flex items-center justify-center gap-1.5 ",onClick:e=>{e.stopPropagation(),handleClick()},"aria-label":`View full details for ${propertySummary}`,children:["View Details",(0,jsx_runtime.jsx)("span",{"aria-hidden":"true",children:"‚Üí"})]})]})]});var price}function PropertyResults({listings,onViewDetails}){const[showAll,setShowAll]=(0,react.useState)(!1);if(!listings||0===listings.length)return(0,jsx_runtime.jsxs)("div",{className:"mt-4 p-6 bg-gray-50 rounded-xl border border-gray-200 text-center space-y-3",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-center",children:(0,jsx_runtime.jsx)("div",{className:"p-3 bg-white rounded-full shadow-sm",children:(0,jsx_runtime.jsx)(house.Z,{className:"w-8 h-8 text-gray-400"})})}),(0,jsx_runtime.jsxs)("div",{className:"space-y-1",children:[(0,jsx_runtime.jsx)("p",{className:"text-gray-700 font-medium",children:"No properties found"}),(0,jsx_runtime.jsx)("p",{className:"text-sm text-gray-500",children:"Try adjusting your search criteria or exploring different neighborhoods."})]})]});const displayedListings=showAll?listings:listings.slice(0,5),hasMore=listings.length>5;return(0,jsx_runtime.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-between px-1",children:(0,jsx_runtime.jsxs)("p",{className:"text-sm font-semibold text-gray-700",children:["Found ",listings.length," ",1===listings.length?"property":"properties"]})}),(0,jsx_runtime.jsx)("div",{className:" grid grid-cols-1 md:grid-cols-2 gap-4 animate-fadeIn ",children:displayedListings.map(((listing,index)=>(0,jsx_runtime.jsx)("div",{className:"animate-slideUp",style:{animationDelay:.1*index+"s"},children:(0,jsx_runtime.jsx)(PropertyCard,{listing,onViewDetails})},listing.mlsNumber)))}),hasMore&&(0,jsx_runtime.jsx)("div",{className:"flex justify-center pt-2",children:(0,jsx_runtime.jsx)("button",{onClick:()=>setShowAll(!showAll),className:" flex items-center gap-2 px-6 py-2 bg-white border-2 border-gray-300 text-gray-700 font-medium text-sm rounded-lg hover:border-blue-500 hover:text-blue-600 active:scale-95 transition-all duration-200 ","aria-label":showAll?"Show fewer properties":"Show all properties",children:showAll?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Show Less",(0,jsx_runtime.jsx)(chevron_up.Z,{className:"w-4 h-4"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Show ",listings.length-5," More",(0,jsx_runtime.jsx)(chevron_down.Z,{className:"w-4 h-4"})]})})})]})}if(PropertyCard.__docgenInfo={description:"PropertyCard Component\n\nDisplays a single property listing in a beautiful, responsive card format.\nIncludes image, price, specs (bed/bath/sqft), and address.\n\nFeatures:\n- Lazy-loaded images with placeholder\n- Responsive design (full width mobile, fixed width desktop)\n- Hover effects\n- Accessible with ARIA labels",methods:[],displayName:"PropertyCard",props:{listing:{required:!0,tsType:{name:"PropertyListing"},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(listing: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"listing"}],return:{name:"void"}}},description:""}}},"undefined"!=typeof document){const style=document.createElement("style");style.textContent="\n    @keyframes fadeIn {\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    }\n\n    @keyframes slideUp {\n      from {\n        opacity: 0;\n        transform: translateY(10px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n\n    .animate-fadeIn {\n      animation: fadeIn 0.5s ease-out;\n    }\n\n    .animate-slideUp {\n      opacity: 0;\n      animation: slideUp 0.4s ease-out forwards;\n    }\n  ",document.head.querySelector("style[data-property-animations]")||(style.setAttribute("data-property-animations","true"),document.head.appendChild(style))}function ChatWidget({isOpen,onClose,brokerageName,brokerageLogo,welcomeMessage,placeholder,repliersApiKey,openaiApiKey,mcpConfig}){const{messages,isLoading,sendMessage}=function useChatRuntime(repliersApiKey,openaiApiKey,mcpConfig,brokerageName="Real Estate Assistant",welcomeMessage=DEFAULT_WELCOME_MESSAGE){const nlpService=(0,react.useMemo)((()=>new RepliersNLPService(repliersApiKey)),[repliersApiKey]),mcpService=(0,react.useMemo)((()=>(null==mcpConfig?void 0:mcpConfig.enabled)?"http"===mcpConfig.mode?new RepliersMCPServiceHttp(mcpConfig.serverUrl):"stdio"===mcpConfig.mode?(useChatRuntime_console.warn("MCP stdio mode is not supported in browser environment. Please use 'http' mode."),null):null:null),[mcpConfig,repliersApiKey]),chatGPT=(0,react.useMemo)((()=>openaiApiKey?new OpenAIService(openaiApiKey,brokerageName):null),[openaiApiKey,brokerageName]),[messages,setMessages]=(0,react.useState)([{id:"welcome",role:"assistant",content:welcomeMessage,timestamp:new Date}]),[isLoading,setIsLoading]=(0,react.useState)(!1),[mcpConnected,setMcpConnected]=(0,react.useState)(!1);(0,react.useEffect)((()=>(mcpService&&!mcpConnected&&(useChatRuntime_console.log("üîå Attempting to connect to MCP server..."),mcpService.connect().then((()=>{setMcpConnected(!0),useChatRuntime_console.log("‚úÖ MCP server connected successfully")})).catch((error=>{useChatRuntime_console.error("‚ùå Failed to connect to MCP server:",error),useChatRuntime_console.log("‚ö†Ô∏è Will fall back to direct NLP API")}))),()=>{mcpService&&mcpConnected&&mcpService.disconnect()})),[mcpService,mcpConnected]);const executeSearch=(0,react.useCallback)((async params=>{useChatRuntime_console.group("üîç Executing Property Search"),useChatRuntime_console.log("Search parameters:",params),useChatRuntime_console.log("MCP connected:",mcpConnected),useChatRuntime_console.log("MCP service available:",!!mcpService);try{if(mcpService&&mcpConnected&&mcpService.isReady()){useChatRuntime_console.log("Using MCP Service");const listings=await mcpService.searchListings(params);return useChatRuntime_console.log(`‚úÖ MCP search completed: ${listings.length} listings`),useChatRuntime_console.groupEnd(),listings}useChatRuntime_console.log("Falling back to NLP API");const queryParts=[];params.bedrooms&&queryParts.push(`${params.bedrooms} bedroom`),params.bathrooms&&queryParts.push(`${params.bathrooms} bathroom`),params.propertyType&&queryParts.push(params.propertyType),params.class&&queryParts.push(params.class),params.type&&queryParts.push(`for ${params.type}`),params.keywords&&params.keywords.length>0&&queryParts.push(...params.keywords);let query=queryParts.join(" ");params.city?(query+=` in ${params.city}`,params.province&&(query+=`, ${params.province}`)):params.province&&(query+=` in ${params.province}`),(params.minPrice||params.maxPrice)&&(params.minPrice&&params.maxPrice?query+=` between $${params.minPrice.toLocaleString()} and $${params.maxPrice.toLocaleString()}`:params.minPrice?query+=` over $${params.minPrice.toLocaleString()}`:params.maxPrice&&(query+=` under $${params.maxPrice.toLocaleString()}`)),useChatRuntime_console.log("Generated NLP query:",query),useChatRuntime_console.log("Keywords for NLP:",params.keywords||"none");const nlpResponse=await nlpService.processQuery(query,params.keywords),listings=await nlpService.searchListings(nlpResponse.request.url,nlpResponse.request.body,params.keywords);return useChatRuntime_console.log(`‚úÖ NLP search completed: ${listings.length} listings`),useChatRuntime_console.groupEnd(),listings}catch(error){throw useChatRuntime_console.error("‚ùå Search failed:",error),useChatRuntime_console.groupEnd(),error}}),[mcpService,mcpConnected,nlpService]),handleChatGPTMessage=(0,react.useCallback)((async userMessage=>chatGPT?await chatGPT.chat(userMessage):{message:"I specialize in helping you find properties! Try asking me something like '3 bedroom condo in Toronto' or 'house under $800k with a backyard'.",needsSearch:!1}),[chatGPT]),sendMessage=(0,react.useCallback)((async content=>{if(!content.trim()||isLoading)return;const userMessage={id:`user-${Date.now()}`,role:"user",content:content.trim(),timestamp:new Date};setMessages((prev=>[...prev,userMessage])),setIsLoading(!0);try{const chatResponse=await handleChatGPTMessage(content);if(chatResponse.needsSearch&&chatResponse.searchParams){if(useChatRuntime_console.log("üîß ChatGPT requested search with params:",chatResponse.searchParams),chatResponse.message){const gptMessage={id:`gpt-${Date.now()}`,role:"assistant",content:chatResponse.message,timestamp:new Date};setMessages((prev=>[...prev,gptMessage]))}const searchingMessage={id:`searching-${Date.now()}`,role:"assistant",content:"Searching for properties...",timestamp:new Date,isLoading:!0};setMessages((prev=>[...prev,searchingMessage]));const listings=await executeSearch(chatResponse.searchParams);setMessages((prev=>prev.filter((msg=>msg.id!==searchingMessage.id)))),chatGPT&&chatResponse.toolCallId&&chatGPT.addSearchResults(chatResponse.toolCallId,listings);const resultMessage={id:`result-${Date.now()}`,role:"assistant",content:`I found ${listings.length} ${1===listings.length?"property":"properties"} matching your criteria!`,propertyResults:listings.length>0?listings:void 0,timestamp:new Date};setMessages((prev=>[...prev,resultMessage]))}else{const responseMessage={id:`response-${Date.now()}`,role:"assistant",content:chatResponse.message,timestamp:new Date};setMessages((prev=>[...prev,responseMessage]))}chatGPT&&chatGPT.trimHistory(20)}catch(error){useChatRuntime_console.error("Error processing message:",error),setMessages((prev=>prev.filter((msg=>!msg.isLoading))));const errorMessage={id:`error-${Date.now()}`,role:"assistant",content:getErrorMessage(error),timestamp:new Date,error:!0};setMessages((prev=>[...prev,errorMessage]))}finally{setIsLoading(!1)}}),[isLoading,handleChatGPTMessage,executeSearch,chatGPT]),resetConversation=(0,react.useCallback)((()=>{nlpService.resetContext(),chatGPT&&chatGPT.resetConversation(),setMessages([{id:"welcome",role:"assistant",content:welcomeMessage,timestamp:new Date}]),setIsLoading(!1)}),[nlpService,chatGPT,welcomeMessage]);return{messages,isLoading,sendMessage,resetConversation}}(repliersApiKey,openaiApiKey,mcpConfig,brokerageName,welcomeMessage),[inputValue,setInputValue]=(0,react.useState)(""),messagesEndRef=(0,react.useRef)(null),inputRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{var _messagesEndRef_current;null===(_messagesEndRef_current=messagesEndRef.current)||void 0===_messagesEndRef_current||_messagesEndRef_current.scrollIntoView({behavior:"smooth"})}),[messages]),(0,react.useEffect)((()=>{var _inputRef_current;!isLoading&&isOpen&&(null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.focus())}),[isLoading,isOpen]);const handleSend=()=>{inputValue.trim()&&!isLoading&&(sendMessage(inputValue),setInputValue(""))};return isOpen?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 transition-opacity duration-300 md:hidden",onClick:onClose,"aria-hidden":"true"}),(0,jsx_runtime.jsxs)("div",{className:`\n          fixed z-50 bg-white rounded-2xl shadow-2xl\n          flex flex-col overflow-hidden\n          transition-all duration-300 ease-out\n          ${isOpen?"opacity-100 translate-y-0 scale-100":"opacity-0 translate-y-4 scale-95 pointer-events-none"}\n\n          /* Mobile: Full screen */\n          inset-4 md:inset-auto\n\n          /* Desktop: Bottom right, fixed size - wider for property cards */\n          md:bottom-24 md:right-6\n          md:w-[480px] md:h-[700px]\n        `,role:"dialog","aria-labelledby":"chat-header","aria-modal":"true",children:[(0,jsx_runtime.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 flex items-center justify-between shadow-lg",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-3",children:[brokerageLogo&&(0,jsx_runtime.jsx)("img",{src:brokerageLogo,alt:`${brokerageName} logo`,className:"w-10 h-10 rounded-full bg-white/10 p-1 object-contain"}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{id:"chat-header",className:"font-semibold text-lg",children:brokerageName}),(0,jsx_runtime.jsx)("p",{className:"text-xs text-blue-100",children:"Online now"})]})]}),(0,jsx_runtime.jsx)("button",{onClick:onClose,"aria-label":BUTTON_LABELS_CLOSE,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:(0,jsx_runtime.jsx)(x.Z,{className:"w-5 h-5"})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-b from-blue-50/30 to-white",children:[messages.map((message=>(0,jsx_runtime.jsxs)("div",{className:"space-y-3",children:[(0,jsx_runtime.jsx)("div",{className:"flex "+("user"===message.role?"justify-end":"justify-start"),children:(0,jsx_runtime.jsxs)("div",{className:`\n                    max-w-[85%] rounded-2xl px-4 py-3 shadow-sm\n                    ${"user"===message.role?"bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-br-sm":message.error?"bg-red-50 text-red-800 rounded-bl-sm border border-red-200":message.isLoading?"bg-blue-50 text-blue-800 rounded-bl-sm border border-blue-200 flex items-center gap-2":"bg-white text-gray-800 rounded-bl-sm border border-gray-100"}\n                  `,children:[message.isLoading&&(0,jsx_runtime.jsx)(loader_circle.Z,{className:"w-4 h-4 animate-spin"}),(0,jsx_runtime.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:message.content})]})}),"assistant"===message.role&&message.propertyResults&&message.propertyResults.length>0&&(0,jsx_runtime.jsx)("div",{className:"w-full",children:(0,jsx_runtime.jsx)(PropertyResults,{listings:message.propertyResults})})]},message.id))),isLoading&&!messages.some((m=>m.isLoading))&&(0,jsx_runtime.jsx)("div",{className:"flex justify-start",children:(0,jsx_runtime.jsx)("div",{className:"bg-white text-gray-800 rounded-2xl rounded-bl-sm px-4 py-3 shadow-sm border border-gray-100",children:(0,jsx_runtime.jsx)(loader_circle.Z,{className:"w-5 h-5 animate-spin text-blue-600"})})}),(0,jsx_runtime.jsx)("div",{ref:messagesEndRef})]}),(0,jsx_runtime.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("input",{ref:inputRef,type:"text",value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),handleSend())},placeholder,disabled:isLoading,className:" flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:cursor-not-allowed text-sm transition-all duration-200 ","aria-label":"Message input"}),(0,jsx_runtime.jsx)("button",{onClick:handleSend,disabled:!inputValue.trim()||isLoading,"aria-label":BUTTON_LABELS_SEND,className:" p-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:shadow-lg hover:scale-105 disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-200 flex items-center justify-center ",children:(0,jsx_runtime.jsx)(send.Z,{className:"w-5 h-5"})})]}),(0,jsx_runtime.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Powered by Repliers AI ‚Ä¢ Press Enter to send"})]})]})]}):null}function Chatbot({repliersApiKey,openaiApiKey,mcpConfig,brokerageName="Real Estate Assistant",brokerageLogo,primaryColor,position="bottom-right",welcomeMessage=DEFAULT_WELCOME_MESSAGE,placeholder="e.g., 3 bedroom house in Toronto under $800k..."}){const[isOpen,setIsOpen]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(FloatingButton,{isOpen,onClick:()=>{setIsOpen((prev=>!prev))},position}),(0,jsx_runtime.jsx)(ChatWidget,{isOpen,onClose:()=>{setIsOpen(!1)},brokerageName,brokerageLogo,welcomeMessage,placeholder,repliersApiKey,openaiApiKey,mcpConfig})]})}PropertyResults.__docgenInfo={description:'PropertyResults Component\n\nDisplays a grid of property cards with pagination controls.\n\nFeatures:\n- Responsive grid (1 col mobile, 2 col desktop)\n- Show 5 properties initially, "Show more" for rest\n- Empty state with helpful message\n- Staggered fade-in animations\n- Property count header',methods:[],displayName:"PropertyResults",props:{listings:{required:!0,tsType:{name:"Array",elements:[{name:"PropertyListing"}],raw:"PropertyListing[]"},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(listing: PropertyListing) => void",signature:{arguments:[{type:{name:"PropertyListing"},name:"listing"}],return:{name:"void"}}},description:""}}},ChatWidget.__docgenInfo={description:"",methods:[],displayName:"ChatWidget",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},brokerageName:{required:!0,tsType:{name:"string"},description:""},brokerageLogo:{required:!1,tsType:{name:"string"},description:""},welcomeMessage:{required:!0,tsType:{name:"string"},description:""},placeholder:{required:!0,tsType:{name:"string"},description:""},repliersApiKey:{required:!0,tsType:{name:"string"},description:""},openaiApiKey:{required:!1,tsType:{name:"string"},description:""},mcpConfig:{required:!1,tsType:{name:"union",raw:"MCPStdioConfig | MCPHttpConfig",elements:[{name:"MCPStdioConfig"},{name:"MCPHttpConfig"}]},description:""}}};Chatbot.__docgenInfo={description:'Real Estate Chatbot Component (Step 4: MCP Integration)\n\n@description A conversational AI chatbot for real estate websites that combines:\n- OpenAI ChatGPT for natural, human-friendly conversation\n- Repliers MCP Server for property searches (with NLP fallback)\n\nArchitecture (Step 4):\n1. ChatGPT handles ALL conversation and extracts search parameters\n2. When ready to search, ChatGPT returns structured parameters\n3. MCP Service executes search using Repliers MCP Server tools\n4. Results are shown to user AND sent back to ChatGPT for discussion\n\nFeatures:\n- Floating action button with smooth animations\n- Modal chat interface (responsive: full-screen mobile, panel desktop)\n- Natural conversation powered by ChatGPT with function calling\n- Property search via Repliers MCP Server (or NLP fallback)\n- Beautiful property cards with images and details\n- Customizable branding (logo, colors, messages)\n- Accessible and keyboard-navigable\n\n@param props - The component props\n@returns JSX.Element\n\n@example\n```tsx\n// With MCP Server (recommended)\n<Chatbot\n  repliersApiKey="your_repliers_api_key"\n  openaiApiKey="your_openai_api_key"\n  mcpConfig={{\n    enabled: true,\n    nodePath: "/usr/local/bin/node",\n    serverPath: "/path/to/mcp-server/mcpServer.js"\n  }}\n  brokerageName="Acme Realty"\n/>\n\n// Without MCP (falls back to NLP API)\n<Chatbot\n  repliersApiKey="your_repliers_api_key"\n  openaiApiKey="your_openai_api_key"\n  brokerageName="Acme Realty"\n/>\n```',methods:[],displayName:"Chatbot",props:{repliersApiKey:{required:!0,tsType:{name:"string"},description:"Repliers API key (required for property search)"},openaiApiKey:{required:!1,tsType:{name:"string"},description:"OpenAI API key (optional - for enhanced conversation)"},mcpConfig:{required:!1,tsType:{name:"union",raw:"MCPStdioConfig | MCPHttpConfig",elements:[{name:"MCPStdioConfig"},{name:"MCPHttpConfig"}]},description:"MCP server configuration (optional - for MCP integration)"},brokerageName:{required:!1,tsType:{name:"string"},description:"Name of the brokerage to display in header",defaultValue:{value:'"Real Estate Assistant"',computed:!1}},brokerageLogo:{required:!1,tsType:{name:"string"},description:"URL to brokerage logo image"},primaryColor:{required:!1,tsType:{name:"string"},description:"Primary brand color (hex or Tailwind color)"},position:{required:!1,tsType:{name:"union",raw:'"bottom-right" | "bottom-left"',elements:[{name:"literal",value:'"bottom-right"'},{name:"literal",value:'"bottom-left"'}]},description:"Position of the floating button",defaultValue:{value:'"bottom-right"',computed:!1}},welcomeMessage:{required:!1,tsType:{name:"string"},description:"Custom welcome message from the assistant",defaultValue:{value:"\"Hi! I'm your AI real estate assistant. Tell me what you're looking for and I'll help you find the perfect home.\"",computed:!1}},placeholder:{required:!1,tsType:{name:"string"},description:"Placeholder text for input field",defaultValue:{value:'"e.g., 3 bedroom house in Toronto under $800k..."',computed:!1}}}};const chatbot_stories={title:"pocs/Chatbot/Real Estate Chatbot",component:Chatbot,tags:["autodocs"],parameters:{layout:"fullscreen",docs:{description:{component:'\n# Real Estate Chatbot\n\nAn intelligent, conversational AI chatbot for real estate websites powered by Repliers NLP API\nand optional ChatGPT integration.\n\n## ‚ú® Features\n\n- üó£Ô∏è **Natural Language Search** - "3 bedroom condo in Toronto under $800k"\n- ü§ñ **ChatGPT Integration** - Natural conversation (optional, add OpenAI key)\n- üîÑ **Context-Aware** - Multi-turn refinement maintains conversation context\n- üé® **Visual Search** - Search by aesthetics: "modern white kitchen"\n- üè† **Beautiful UI** - Responsive property cards with images\n- üé® **White-Label Ready** - Customizable branding, logo, and colors\n- üì± **Mobile Optimized** - Full-screen on mobile, panel on desktop\n\n## üöÄ Quick Start\n\n1. **Try the Working Demo** story below\n2. **(Optional)** Add your OpenAI API key for ChatGPT conversation\n3. Search: "3 bedroom condo in Toronto"\n4. Refine: "Under $800k"\n\n## üéØ Example Queries\n\n- "3 bedroom condo in Toronto"\n- "House under $800k with a backyard"\n- "Modern apartment with white kitchen"\n- "Show me properties in the Annex"\n\n## üîë API Keys\n\n- **Repliers API**: Sample key provided - [get yours here](https://repliers.com)\n- **OpenAI API** (optional): For ChatGPT conversation - [get key](https://platform.openai.com)\n\n## üîß Integration\n\nCopy the entire `src/components/chatbot` directory into your project. All dependencies\nare self-contained for easy integration.\n\n```tsx\nimport { Chatbot } from \'@/components/chatbot\';\n\n<Chatbot\n  repliersApiKey="your-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n/>\n```\n        '}}},argTypes:{repliersApiKey:{control:"text",description:"Repliers API key (required for property search)",table:{type:{summary:"string"},defaultValue:{summary:"Sample key provided"}}},openaiApiKey:{control:"text",description:"OpenAI API key (optional - enables ChatGPT for natural conversation). Get yours at platform.openai.com",table:{type:{summary:"string"},defaultValue:{summary:"undefined (uses fallback responses)"}}},brokerageName:{control:"text",description:"Name of the brokerage to display in chat header",table:{type:{summary:"string"},defaultValue:{summary:"Real Estate Assistant"}}},brokerageLogo:{control:"text",description:"URL to brokerage logo image",table:{type:{summary:"string"}}},primaryColor:{control:"color",description:"Primary brand color (future feature)",table:{type:{summary:"string"},defaultValue:{summary:"#3B82F6"}}},position:{control:"radio",options:["bottom-right","bottom-left"],description:"Position of the floating button",table:{type:{summary:"bottom-right | bottom-left"},defaultValue:{summary:"bottom-right"}}},welcomeMessage:{control:"text",description:"Custom welcome message from the assistant",table:{type:{summary:"string"},defaultValue:{summary:"Hi! I'm your AI real estate assistant. Tell me what you're looking for and I'll help you find the perfect home."}}},placeholder:{control:"text",description:"Placeholder text for the message input",table:{type:{summary:"string"},defaultValue:{summary:"e.g., 3 bedroom house in Toronto under $800k..."}}}}},WorkingDemo={args:{repliersApiKey:"pxI19UMy9zfw9vz5lRxoGpjJWXrMnm",openaiApiKey:void 0,brokerageName:"Smart Homes Realty",welcomeMessage:"Hi! I'm your AI real estate assistant. Tell me what you're looking for!",placeholder:"e.g., 3 bedroom house in Toronto under $800k..."},parameters:{docs:{description:{story:'\nThis is a complete, working demonstration of the chatbot with all features:\n\n- **Natural Language Search**: Ask in plain English\n- **Multi-Turn Conversations**: Refine searches with context\n- **Visual Search**: Search by aesthetics (e.g., "modern kitchen")\n- **ChatGPT Integration**: Add your OpenAI key for intelligent conversation\n- **Beautiful UI**: Responsive property cards with images\n\n**Getting Started:**\n1. Try a search query like "3 bedroom condo in Toronto"\n2. (Optional) Add your OpenAI API key for ChatGPT conversation\n3. Watch the console to see API calls in action\n\n**Advanced:** The chatbot also supports MCP server integration for standardized\ntool communication. See the repo documentation for setup details.\n        '}}}},CustomBranding={args:{repliersApiKey:"pxI19UMy9zfw9vz5lRxoGpjJWXrMnm",brokerageName:"Luxury Homes Toronto",brokerageLogo:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=100&h=100&fit=crop",welcomeMessage:"Welcome to Luxury Homes Toronto! Let me help you find your dream property in the heart of the city.",placeholder:"Describe your dream home...",primaryColor:"#1e40af",position:"bottom-right"},parameters:{docs:{description:{story:'\nCustomize every aspect of the chatbot to match your brand:\n\n**Branding Options:**\n- `brokerageName`: Your company name in the header\n- `brokerageLogo`: URL to your logo image\n- `welcomeMessage`: Custom greeting message\n- `placeholder`: Custom input placeholder text\n- `primaryColor`: Brand color (future feature)\n- `position`: "bottom-right" or "bottom-left"\n\n**Example Integration:**\n```tsx\n<Chatbot\n  repliersApiKey="your-key"\n  openaiApiKey="your-openai-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n  welcomeMessage="Welcome! How can I help you find your dream home?"\n  position="bottom-right"\n/>\n```\n        '}}}},UniqueKeywordSearches={args:{repliersApiKey:"pxI19UMy9zfw9vz5lRxoGpjJWXrMnm",openaiApiKey:void 0,brokerageName:"Luxury Properties",welcomeMessage:"Hi! I specialize in finding unique properties with special features. Tell me what makes your dream home special!",placeholder:"e.g., horse farm, home theater, wine cellar..."},parameters:{docs:{description:{story:'\nThis story demonstrates keyword-based searches that go beyond traditional filters:\n\n**What Makes Keywords Special:**\n- Match text in property descriptions\n- Find features in image tags (pools, kitchens, outdoor spaces)\n- Discover lifestyle properties (equestrian, waterfront, golf)\n- Locate luxury amenities (wine cellars, theaters, gyms)\n\n**Example Flow:**\n1. User: "I\'m looking for a horse farm in Orlando"\n2. ChatGPT extracts: `{ city: "Orlando", keywords: ["horse", "farm", "equestrian", "stable", "barn"] }`\n3. NLP endpoint searches descriptions and images for these terms\n4. User gets properties with equestrian facilities!\n\n**Try These Unique Searches:**\n- "Horse farm" ‚Üí Equestrian properties with stables/barns\n- "Wine cellar" ‚Üí Homes with wine storage facilities\n- "Home theater" ‚Üí Properties with dedicated entertainment rooms\n- "Waterfront dock" ‚Üí Properties with water access\n- "Pool sauna" ‚Üí Luxury homes with spa amenities\n\n**Note:** Add your OpenAI API key above for intelligent keyword extraction!\n        '}}}},__namedExportsOrder=["WorkingDemo","CustomBranding","UniqueKeywordSearches"];WorkingDemo.parameters={...WorkingDemo.parameters,docs:{...WorkingDemo.parameters?.docs,source:{originalSource:'{\n  args: {\n    repliersApiKey: SAMPLE_REPLIERS_API_KEY,\n    openaiApiKey: undefined,\n    // ‚¨ÖÔ∏è Paste your OpenAI API key here to enable ChatGPT!\n    brokerageName: "Smart Homes Realty",\n    welcomeMessage: "Hi! I\'m your AI real estate assistant. Tell me what you\'re looking for!",\n    placeholder: "e.g., 3 bedroom house in Toronto under $800k..."\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\nThis is a complete, working demonstration of the chatbot with all features:\n\n- **Natural Language Search**: Ask in plain English\n- **Multi-Turn Conversations**: Refine searches with context\n- **Visual Search**: Search by aesthetics (e.g., "modern kitchen")\n- **ChatGPT Integration**: Add your OpenAI key for intelligent conversation\n- **Beautiful UI**: Responsive property cards with images\n\n**Getting Started:**\n1. Try a search query like "3 bedroom condo in Toronto"\n2. (Optional) Add your OpenAI API key for ChatGPT conversation\n3. Watch the console to see API calls in action\n\n**Advanced:** The chatbot also supports MCP server integration for standardized\ntool communication. See the repo documentation for setup details.\n        `\n      }\n    }\n  }\n}',...WorkingDemo.parameters?.docs?.source},description:{story:'**Working Demo**\n\nA fully functional chatbot with NLP-powered property search.\nThis demonstrates the core functionality with all features enabled.\n\n**Try these queries:**\n- "Hello!" (if you add an OpenAI API key)\n- "3 bedroom condo in Toronto"\n- "House under $800k with a backyard"\n- "Modern apartment with white kitchen"\n- "Show me properties in the Annex"\n\n**NEW: Unique Keyword Searches:**\n- "I\'m looking for a horse farm in Orlando"\n- "House with pool and wine cellar"\n- "Property with home theater"\n- "Waterfront property with dock"\n\n**To enable ChatGPT conversation:**\nAdd your OpenAI API key in the controls below for natural, intelligent dialogue.\n\n**Check the browser console** to see API calls and keyword extraction!',...WorkingDemo.parameters?.docs?.description}}},CustomBranding.parameters={...CustomBranding.parameters,docs:{...CustomBranding.parameters?.docs,source:{originalSource:'{\n  args: {\n    repliersApiKey: SAMPLE_REPLIERS_API_KEY,\n    brokerageName: "Luxury Homes Toronto",\n    brokerageLogo: "https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=100&h=100&fit=crop",\n    welcomeMessage: "Welcome to Luxury Homes Toronto! Let me help you find your dream property in the heart of the city.",\n    placeholder: "Describe your dream home...",\n    primaryColor: "#1e40af",\n    position: "bottom-right"\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\nCustomize every aspect of the chatbot to match your brand:\n\n**Branding Options:**\n- \\`brokerageName\\`: Your company name in the header\n- \\`brokerageLogo\\`: URL to your logo image\n- \\`welcomeMessage\\`: Custom greeting message\n- \\`placeholder\\`: Custom input placeholder text\n- \\`primaryColor\\`: Brand color (future feature)\n- \\`position\\`: "bottom-right" or "bottom-left"\n\n**Example Integration:**\n\\`\\`\\`tsx\n<Chatbot\n  repliersApiKey="your-key"\n  openaiApiKey="your-openai-key"\n  brokerageName="Your Realty"\n  brokerageLogo="https://your-site.com/logo.png"\n  welcomeMessage="Welcome! How can I help you find your dream home?"\n  position="bottom-right"\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}',...CustomBranding.parameters?.docs?.source},description:{story:"**Custom Branding**\n\nThis story shows how to white-label the chatbot with your brokerage's branding.\nCustomize the name, logo, colors, welcome message, and button position.\n\n**Perfect for:**\n- Adding to your real estate website\n- White-labeling for clients\n- Matching your brand identity",...CustomBranding.parameters?.docs?.description}}},UniqueKeywordSearches.parameters={...UniqueKeywordSearches.parameters,docs:{...UniqueKeywordSearches.parameters?.docs,source:{originalSource:'{\n  args: {\n    repliersApiKey: SAMPLE_REPLIERS_API_KEY,\n    openaiApiKey: undefined,\n    // ‚¨ÖÔ∏è Add your OpenAI API key for best results!\n    brokerageName: "Luxury Properties",\n    welcomeMessage: "Hi! I specialize in finding unique properties with special features. Tell me what makes your dream home special!",\n    placeholder: "e.g., horse farm, home theater, wine cellar..."\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\nThis story demonstrates keyword-based searches that go beyond traditional filters:\n\n**What Makes Keywords Special:**\n- Match text in property descriptions\n- Find features in image tags (pools, kitchens, outdoor spaces)\n- Discover lifestyle properties (equestrian, waterfront, golf)\n- Locate luxury amenities (wine cellars, theaters, gyms)\n\n**Example Flow:**\n1. User: "I\'m looking for a horse farm in Orlando"\n2. ChatGPT extracts: \\`{ city: "Orlando", keywords: ["horse", "farm", "equestrian", "stable", "barn"] }\\`\n3. NLP endpoint searches descriptions and images for these terms\n4. User gets properties with equestrian facilities!\n\n**Try These Unique Searches:**\n- "Horse farm" ‚Üí Equestrian properties with stables/barns\n- "Wine cellar" ‚Üí Homes with wine storage facilities\n- "Home theater" ‚Üí Properties with dedicated entertainment rooms\n- "Waterfront dock" ‚Üí Properties with water access\n- "Pool sauna" ‚Üí Luxury homes with spa amenities\n\n**Note:** Add your OpenAI API key above for intelligent keyword extraction!\n        `\n      }\n    }\n  }\n}',...UniqueKeywordSearches.parameters?.docs?.source},description:{story:'**Unique Keyword Searches**\n\nThis story showcases the power of keyword-based searches for finding properties\nwith unique features that traditional filters can\'t capture.\n\n**Perfect for finding:**\n- Lifestyle properties (horse farms, waterfront estates, golf course homes)\n- Luxury amenities (wine cellars, home theaters, pools, saunas)\n- Specific features (fireplaces, hardwood floors, granite counters)\n- Outdoor spaces (decks, patios, gardens, balconies)\n\n**Example queries to try:**\n- "I\'m looking for a horse farm in Orlando"\n- "House with pool and wine cellar in Miami"\n- "Property with home theater and game room"\n- "Waterfront property with private dock"\n- "Home with sauna and gym"\n- "House with granite counters and stainless steel appliances"\n\n**How it works:**\nChatGPT extracts lifestyle keywords from your query and passes them to the\nRepliers NLP endpoint, which matches them against property descriptions and\nimage tags to find exactly what you\'re looking for.\n\n**Watch the console** to see keyword extraction in action!',...UniqueKeywordSearches.parameters?.docs?.description}}}}}]);